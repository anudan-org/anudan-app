<div class="col-12 bg-white" style="position: sticky; top: 80px; z-index: 1040">
  <div class="row">
    <h4 class="col-11 text-left my-3 section-header">
      <div *ngIf="currentClosure.canManage" style="display: flex">
        <div *ngFor="let flow of getForwardFlow()">
          <button [disabled]="wfDisabled" mat-stroked-button
            (click)="submitClosure(flow.toStateId,'Progressing for ' + getStateNameAndOwner(flow.toStateId,true))"
            id="{{ flow.action }}" [class]="
                flow.seqOrder === 0
                  ? 'mr-1 btn btn-sm btn-green-primary'
                  : 'mr-1 btn btn-sm btn-green'
              ">
            {{ flow.action }}
          </button>
        </div>

        <div *ngIf="hasMultipleBackwardFlow()">
          <button [disabled]="
          wfDisabled" mat-stroked-button (click)="returnClosure()"
            [class]="'mr-1 btn btn-sm btn-green border-light-red'">
            Request Modifications
          </button>
        </div>

        <div *ngIf="hasSingleBackwardFlow()">
          <ng-container>
            <button [disabled]="
          wfDisabled" mat-stroked-button
              (click)="submitClosure(getSingleBackwardFlow().toStateId,'<span class=\'text-light-red\'>Returning to </span>' + getStateNameAndOwner(getSingleBackwardFlow().fromStateId,false))"
              [class]="'mr-1 btn btn-sm btn-green border-light-red'">
              Request Modifications
            </button>
          </ng-container>
        </div>
      </div>
    </h4>
    <div class="col-1 text-right" style="display: flex; align-items: center; justify-content: flex-start">
      <mat-icon mat-button [matMenuTriggerFor]="menu" class="float-right" style="cursor: pointer">more_vert</mat-icon>
      <mat-menu #menu="matMenu">
        <button mat-menu-item (click)="showWFAssigments()">
          <mat-icon class="ml-1">assignment</mat-icon>Manage Assignments
        </button>
        <button mat-menu-item (click)="showHistory('grant-closure', currentClosure)">
          <mat-icon class="ml-1">comment</mat-icon>View Notes
        </button>
        <hr>
        <button mat-menu-item (click)="saveAs('closure_'+currentClosure.grant.name+'.pdf')">
          <mat-icon class="ml-1">picture_as_pdf</mat-icon>Export for Offline
          Viewing
        </button>

        <ng-container>
          <hr />
          <button mat-menu-item (click)="manageGrant()">
            <img class="ml-2 mr-3" alt="View Grant Link" style="width: 20px; height: 20px"
              src="./assets/img/dp.svg" />View Grant
          </button>
        </ng-container>
      </mat-menu>
    </div>
  </div>
</div>

<div [ngClass]="currentClosure.canManage?'main-content no-top-margin1':'main-content no-top-margin3'"
  style="margin-top: 40px;">
  <div class="container-fluid anudan-scrollable" style="background: #fff;">
    <div class="row anu-container">
      <div #reportSummary class="col-lg-12">
        <div #container class="container text-left mt-5 px-5 py-5">
          <!--MANAGEMENT SECTION-->

          <kendo-pdf-export #pdf paperSize="A4" forcePageBreak=".page-break"
            [margin]="{ top: '2cm', bottom: '3cm', right: '2cm', left: '2cm' }" [imageResolution]="200" [scale]="0.7"
            [repeatHeaders]="true">
            <div class="row w-100" id="reportSummary">
              <div class="col-11 mb-2 pb-2" style="border-bottom: 3px solid #a6a6a6">
                <div class="row">
                  <div class="col-3">
                    <img alt="img" [src]="logoUrl" alt="logo" class="img-fluid" />
                  </div>
                  <div class="col-9 text-left pl-3" style="display: flex; align-items: center">
                    <div class="row">
                      <div class="col-12">
                        <h4 class="m-0" type="text" autocomplete="off">
                          <strong>{{ 'Closure Request for ' + currentClosure.grant.name }}</strong>
                        </h4>
                      </div>
                      <div class="col-12 text-left">
                        <div [ngClass]="isExternalGrant(currentClosure.grant)?'status-indicator3':'status-indicator2'"
                          style="justify-content: flex-start !important;">
                          <div
                            [class]="'text-center status-icon state-'+(isExternalGrant(currentClosure.grant)?'ext-':'')+currentClosure.status.internalStatus.toLowerCase()">
                          </div>{{currentClosure.status.name | uppercase}}
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <hr />
              <div class="col-12 mb-2 m-2" style="background: #f9f9f9">
                <div class="row">
                  <div class="col-12 mb-0">
                    <span style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">Grant Name:</span>
                    <div class="ml-0 mb-2">
                      <strong>{{
                        (currentClosure.grant.referenceNo
                        ? currentClosure.grant.referenceNo + " | "
                        : "") + currentClosure.grant.name
                        }}</strong>
                    </div>
                  </div>
                  <div class="col-6 mb-2">
                    <span style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">Implementing
                      Organization:</span>
                    <div class="ml-0 mb-0">
                      <strong>{{ currentClosure.grant.organization.name }}</strong>
                    </div>
                  </div>
                  <div class="col-6 mb-0">
                    <span style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">Implementing
                      Organization Representative:</span>
                    <div class="ml-0 mb-0">
                      <strong>{{ currentClosure.grant.representative }}</strong>
                    </div>
                  </div>
                  <div class="col-3 mb-2">
                    <span style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">Grant Start
                      Date:</span>
                    <div class="ml-0 mb-0">
                      <strong>{{ currentClosure.grant.stDate | date: "dd-MMM-yyyy" }}</strong>
                    </div>
                  </div>
                  <div class="col-3 mb-2">
                    <span style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">Grant End
                      Date:</span>
                    <div class="ml-0 mb-3">
                      <strong>{{ currentClosure.grant.enDate | date: "dd-MMM-yyyy" }}</strong>
                    </div>
                  </div>
                  <div class="col-6 mb-2">
                    <span style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">Grant Amount:</span>
                    <div class="ml-0 mb-3" style="display: flex; align-items: center">
                      <strong>{{
                        getFormattedGrantAmount(currentClosure.grant.amount)
                        }}&nbsp;&nbsp;&nbsp;
                        <small>{{
                          getGrantAmountInWords(currentClosure.grant.amount)
                          }}</small></strong>
                    </div>
                  </div>


                </div>
              </div>

              <div class="col-4 mb-2">
                <span style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">Closure Reason:</span>
                <div class="ml-0 mb-3">
                  <strong>{{ currentClosure.reason.reason }}</strong>
                </div>
              </div>
              <div class="col-12 mb-2">
                <span style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">Closure
                  Description:</span>
                <div class="ml-0 mb-3">
                  <strong>{{ currentClosure.description}}</strong>
                </div>
              </div>

              <!-- SUMMARY -->
              <div class="col-12">
                <div class="row px-3">
                  <div class="col-3 px-0">
                    <span style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">Project Funds
                      Summary:</span>
                  </div>
                  <div class="col-12 app-summary-class"
                    style="background: rgb(255, 255, 255); border-left-color: rgb(255, 191, 0); border-left-width: 4px; box-shadow: rgb(215, 215, 215) 4px 4px 10px; cursor: pointer;">
                    <div class="row h-100">
                      <div class="col-4 px-0 my-3 d-flex flex-column justify-content-center align-items-start">
                        <div class="text-center w-100"
                          style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                          {{getPlannedFunds(0)}}</div>
                        <div class="text-center w-100"
                          style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                          Grant Commitment</div>
                      </div>
                      <div class="col-4 px-0 my-3 d-flex flex-column justify-content-center align-items-start">
                        <div class="text-center w-100"
                          style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                          {{getReceivedFunds(0)}}</div>
                        <div class="text-center w-100"
                          style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                          Disbursed Till Date</div>
                      </div>
                      <div class="col-4 px-0 my-3 d-flex flex-column justify-content-center align-items-start">
                        <div class="text-center w-100"
                          style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                          {{getPlannedDiff(0)}}</div>
                        <div class="text-center w-100"
                          style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                          Undisbursed Amount</div>
                      </div>
                      <div class="col-4 px-0 my-3 d-flex flex-column justify-content-center align-items-start">
                        <div class="text-center w-100 text-grey"
                          style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                          {{getPlannedFunds(1)}}</div>
                        <div class="text-center w-100"
                          style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                          Other Sources Commitment</div>
                      </div>
                      <div class="col-4 px-0 my-3 d-flex flex-column justify-content-center align-items-start">
                        <div class="text-center w-100 text-grey"
                          style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                          {{getReceivedFunds(1)}}</div>
                        <div class="text-center w-100"
                          style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                          Received Till Date</div>
                      </div>
                      <div class="col-4 px-0 my-3 d-flex flex-column justify-content-center align-items-start">
                        <div class="text-center w-100 text-grey"
                          style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                          {{getPlannedDiff(1)}}</div>
                        <div class="text-center w-100"
                          style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                          Pending Amount</div>
                      </div>
                    </div>
                  </div>

                  <div class="col-12">
                    <hr />
                  </div>
                  <div class="col-12 px-0">
                    <p style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">Record of Spends</p>
                  </div>
                  <div class="col-4 unspent-class px-0">
                    <div class="text-center w-100"
                      style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                      {{getFormattedRefundAmount(currentClosure.grant.actualSpent)}}</div>
                    <div class="text-center w-100"
                      style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                      Actual Spent</div>

                  </div>
                  <div class="col-4">
                    <div class="text-center w-100"
                      style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                      {{getRecievedDiff(0)}}</div>
                    <div class="text-center w-100"
                      style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                      Unspent Amount</div>
                  </div>

                  <div class="col-12">
                    <hr />
                  </div>
                  <div class="col-12 px-0" *ngIf="currentClosure.grant.refundAmount!==undefined">
                    <p style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">Refund Request</p>
                  </div>
                  <div class="col-4" *ngIf="currentClosure.grant.refundAmount!==undefined">
                    <div class="text-center w-100"
                      style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                      {{getRefundAmount()}}</div>
                    <div class="text-center w-100"
                      style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                      Refund Requested</div>
                  </div>
                  <div class="col-4" *ngIf="currentClosure.grant.refundAmount!==undefined">
                    <div class="text-center w-100"
                      style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                      {{getRefundReceived()}}</div>
                    <div class="text-center w-100"
                      style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                      Refund Received</div>
                  </div>
                  <div class="col-4" *ngIf="currentClosure.grant.refundAmount!==undefined">
                    <div class="text-center w-100"
                      style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                      {{'₹ 50000'}}</div>
                    <div class="text-center w-100"
                      style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                      Pending Amount</div>
                  </div>
                  <div class="col-12 px-0" *ngIf="currentClosure.grant.hasOngoingDisbursement">
                    <p style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">On-going Disbursement
                    </p>
                  </div>

                  <div class="row px-3" *ngIf="currentClosure.grant.hasOngoingDisbursement">
                    <div class="col-4">
                      <div class="text-center w-100"
                        style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                        {{getFormattedCurrency(currentClosure.grant.ongoingDisbursementAmount)}}</div>
                      <div class="text-center w-100"
                        style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                        Requested Disbursement Amount</div>
                    </div>
                    <div class="col-4">
                      <div class="text-center w-100"
                        style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                        {{getFormattedCurrency(currentClosure.grant.actualOngoingDisbursementRecorded)}}</div>
                      <div class="text-center w-100"
                        style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                        Recorded Actual Disbursement</div>
                    </div>
                    <div class="col-4">
                      <div class="text-center w-100"
                        style="font-weight: 800;font-size: 20px;color: #0E100E;font-family:Archivo, sans-serif;">
                        {{currentClosure.grant.ongoingDisbursementNote}}</div>
                      <div class="text-center w-100"
                        style="font-weight: 400;color: rgba(14, 16, 14, 0.68);font-size: 12px;font-family:Lato, sans-serif;">
                        Disbursement Request Note</div>
                    </div>
                    <div class="col-12 px-0">
                      <hr>
                    </div>
                  </div>
                </div>

              </div>


              <div class="col-12" style="position:absolute; top :-2000px;z-index:-1;">
                <ng-container *ngFor="let section of currentClosure.closureDetails.sections">
                  <div>
                    <ng-container #sectionsContainer *ngFor="let attribute of section.attributes; let i = index">
                      <div id="fieldBlock_{{ attribute.id }}" class="row mb-4 mt-2" style="
                  border: 1px solid #ececec;
                  border-radius: 4px;
                  padding: 20px;
                  background: #fcfcfc;
                ">
                        <ng-container class="mb-2">
                          <div class="col-sm-4 col-lg-8" *ngIf="
                      attribute.fieldType === 'multiline' &&
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse
                    ">
                            <mat-form-field>
                              <input id="field_{{ attribute.id }}" [(ngModel)]="attribute.fieldName" class="anu-input"
                                [ngModelOptions]="{ standAlone: true }" matInput placeholder="Title" />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-4 col-lg-8" *ngIf="
                      attribute.fieldType === 'multiline' &&
                      currentClosure.canManage &&
                      currentClosure.forGranteeUse
                    ">

                            <label>Title:</label>
                            <p>{{ attribute.fieldName }}</p>
                          </div>
                          <div class="col-sm-4 col-lg-8" *ngIf="attribute.fieldType === 'document'">
                            <mat-form-field *ngIf="
                        currentClosure.canManage &&
                        !currentClosure.forGranteeUse
                      ">

                              <input id="field_{{ attribute.id }}" [(ngModel)]="attribute.fieldName" class="anu-input"
                                [ngModelOptions]="{ standAlone: true }" matInput placeholder="Title" />
                            </mat-form-field>
                            <label *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      ">Title:</label>
                            <p class="anu-input" *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      " style="background: #f0f1f0 !important">
                              {{ attribute.fieldName }}
                            </p>
                          </div>
                          <div class="col-sm-4 col-lg-8" *ngIf="attribute.fieldType === 'text'">
                            <mat-form-field>
                              <input id="field_{{ attribute.id }}" [(ngModel)]="attribute.fieldName" class="anu-input"
                                [ngModelOptions]="{ standAlone: true }" matInput placeholder="Title" />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-8 col-lg-8" *ngIf="attribute.fieldType === 'table'">
                            <mat-form-field *ngIf="
                        currentClosure.canManage &&
                        !currentClosure.forGranteeUse
                      ">
                              <input id="field_{{ attribute.id }}" [(ngModel)]="attribute.fieldName" class="anu-input"
                                [ngModelOptions]="{ standAlone: true }" matInput placeholder="Title" />
                            </mat-form-field>
                            <label *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      ">Title:</label>
                            <p class="anu-input" *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      " style="background: #f0f1f0 !important">
                              {{ attribute.fieldName }}
                            </p>
                          </div>

                          <div *ngIf="attribute.fieldType === 'disbursement'" class="col-12 mb-3">
                            <div class="row mb-3">
                              <div class="col-4" style="display: flex;align-items: center;">
                                <p class="text-header">Project Fund Summary</p>
                              </div>
                              <div class="col-8" style="display: flex; justify-content: right; align-items: center;">

                              </div>
                              <div class="col-12">
                                <div class="row">
                                  <div class="col-3">
                                    <mat-form-field>
                                      <input matInput disabled readonly placeholder="Grant Commitment"
                                        [value]="getPlannedFunds(0)">
                                    </mat-form-field>
                                  </div>
                                  <div class="col-3">
                                    <mat-form-field>
                                      <input matInput disabled readonly placeholder="Disbursed Till Date"
                                        [value]="getReceivedFunds(0)">
                                    </mat-form-field>
                                  </div>
                                  <div class="col-3">
                                    <mat-form-field>
                                      <input matInput disabled readonly placeholder="Undisbursed Amount"
                                        [value]="getPlannedDiff(0)">
                                    </mat-form-field>
                                  </div>
                                  <div class="col-3">
                                    <button class="btn btn-sm btn-green"
                                      *ngIf="getPlannedFunds(0)!==getReceivedFunds(0) &&  (currentClosure.grant.refundAmount===undefined || currentClosure.grant.refundAmount===null )"
                                      [disabled]="currentClosure.grant.hasOngoingDisbursement ">{{currentClosure.grant.hasOngoingDisbursement?'Disbursement
                                      Request In-Progress':'Initiate Disbursement'}}</button>
                                  </div>
                                  <div class="col-3">
                                    <mat-form-field>
                                      <input matInput disabled readonly placeholder="Other Sources Commitment"
                                        [value]="getPlannedFunds(1)">
                                    </mat-form-field>
                                  </div>
                                  <div class="col-3">
                                    <mat-form-field>
                                      <input matInput disabled readonly placeholder="Received Till Date"
                                        [value]="getReceivedFunds(1)">
                                    </mat-form-field>
                                  </div>
                                  <div class="col-3">
                                    <mat-form-field>
                                      <input matInput disabled readonly placeholder="Pending Amount"
                                        [value]="getPlannedDiff(1)">
                                    </mat-form-field>
                                  </div>
                                  <div class="col-12">
                                    <hr />
                                  </div>

                                  <div class="col-3">
                                    <mat-form-field *ngIf="
                                currentClosure.canManage &&
                                !currentClosure.forGranteeUse
                              ">
                                      <input (blur)="showFormattedActualSpent($event)" #refundAmount
                                        [(ngModel)]="currentClosure.grant.actualSpent" class="anu-input"
                                        [ngModelOptions]="{ standAlone: true }" matInput
                                        placeholder="Record Spent (₹) - Till Date" />
                                      <p #grantRefundFormatted (click)="showActualSpentInput($event)"
                                        class="anu-input w-100 text-right"
                                        style="position: absolute; top: 5px; cursor: text"
                                        [innerHtml]="getFormattedRefundAmount(currentClosure.grant.actualSpent)">
                                      </p>
                                    </mat-form-field>
                                  </div>
                                  <div class="col-3">
                                    <mat-form-field>
                                      <input matInput disabled readonly placeholder="Unspent Amount"
                                        [value]="getRecievedDiff(0)">
                                    </mat-form-field>
                                  </div>
                                  <div class="col-3">
                                    <button
                                      *ngIf="!currentClosure.grant.hasOngoingDisbursement && (currentClosure.grant.refundAmount===undefined || currentClosure.grant.refundAmount===null)"
                                      class="btn btn-sm btn-green" (click)="captureRefund()">Initiate
                                      Refund</button>
                                  </div>
                                  <div class="col-12">
                                    <hr />
                                  </div>
                                  <div class="col-3">
                                    <mat-form-field>
                                      <input matInput disabled readonly placeholder="Refund Requested"
                                        [value]="getRefundAmount()">
                                    </mat-form-field>
                                  </div>
                                  <div class="col-3">
                                    <mat-form-field>
                                      <input matInput disabled readonly placeholder="Refund Received"
                                        [value]="getRefundReceived()">
                                    </mat-form-field>
                                  </div>
                                  <div class="col-3">
                                    <mat-form-field>
                                      <input matInput disabled readonly placeholder="Pending Amount"
                                        [value]="'₹ 50000'">
                                    </mat-form-field>
                                  </div>
                                </div>

                              </div>
                            </div>
                          </div>
                          <div class="col-sm-4 col-lg-8" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse &&
                      attribute.canEdit
                    ">
                            <mat-form-field>
                              <input [(ngModel)]="attribute.fieldName" class="anu-input"
                                [ngModelOptions]="{ standAlone: true }" matInput placeholder="Title" />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-4 col-lg-8" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse &&
                      !attribute.canEdit
                    ">
                            <mat-form-field>
                              <input [(ngModel)]="attribute.fieldName" class="anu-input"
                                [ngModelOptions]="{ standAlone: true }" disabled readonly
                                style="background: #f0f1f0 !important" matInput placeholder="Title" />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-4 col-lg-8" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      currentClosure.canManage &&
                      currentClosure.forGranteeUse
                    ">
                            <mat-form-field>
                              <input [(ngModel)]="attribute.fieldName" class="anu-input"
                                [ngModelOptions]="{ standAlone: true }" readonly disabled
                                style="background: #f0f1f0 !important" matInput placeholder="Title" />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse &&
                      attribute.canEdit
                    ">

                            <label *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      ">Type:</label>
                            <p class="anu-input" *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      " style="background: #f0f1f0 !important">
                              {{ getFieldTypeDisplayValue(attribute.fieldType) }}
                            </p>
                          </div>

                          <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse &&
                      !attribute.canEdit
                    ">
                            <mat-form-field>
                              <input matInput placeholder="Type:" disabled readonly class="anu-input"
                                style="background: #f0f1f0 !important" [value]="
                          getFieldTypeDisplayValue(attribute.fieldType)
                        " />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      currentClosure.canManage &&
                      currentClosure.forGranteeUse
                    ">
                            <mat-form-field>
                              <input matInput placeholder="Type:" disabled readonly class="anu-input"
                                style="background: #f0f1f0 !important" [value]="
                          getFieldTypeDisplayValue(attribute.fieldType)
                        " />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-3 col-lg-3 text-left" *ngIf="attribute.fieldType === 'text'">
                            <mat-form-field>
                              <input matInput [(ngModel)]="attribute.fieldValue" class="anu-input"
                                [ngModelOptions]="{ standAlone: true }" placeholder="Field Value" />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-12 col-lg-11 text-left" *ngIf="attribute.fieldType === 'table'">
                            <div class="row">
                              <div class="col-12 text-right">
                                <span *ngIf="
                            currentClosure.canManage &&
                            !currentClosure.forGranteeUse
                          " style="cursor: pointer"><em class="fas fa-plus-circle text-green mr-1"></em>Add a
                                  column</span>
                              </div>
                              <div style="margin-left: 250px">
                                <em class="fas fa-arrow-alt-circle-left mr-3"></em><em
                                  class="fas fa-arrow-alt-circle-right"></em>
                              </div>
                            </div>
                            <div id="tableArea" class="row flex-row flex-nowrap"
                              style="overflow: hidden; overflow-x: scroll">
                              <table id="tablePlaceholderX" class='refunds-holder'>
                                <caption></caption>
                                <tr>
                                  <th id="col1" style="
                              min-width: 250px;width:20%;
                              position: sticky;
                              left: 0;
                              z-index: 1;
                              background: rgb(244, 244, 244);
                            ">
                                    &nbsp;
                                  </th>
                                  <ng-container *ngIf="attribute.fieldTableValue[0]">
                                    <ng-container *ngFor="
                                let column of attribute.fieldTableValue[0]
                                  .columns;
                                let i = index
                              ">
                                      <th [id]="'col_'+i" style="border: 1px solid #e4e4e4">
                                        <mat-form-field *ngIf="
                                    currentClosure.canManage &&
                                    !currentClosure.forGranteeUse
                                  ">
                                          <mat-icon *ngIf="
                                      currentClosure.canManage &&
                                      !currentClosure.forGranteeUse
                                    " aria-hidden="false" style="
                                      font-size: 18px;
                                      position: relative;
                                      left: 90%;
                                      z-index: 0;
                                      cursor: pointer;
                                      top: 3px;
                                    " aria-label="Example home icon" inline="false" title="Delete this column">
                                            delete_outline
                                          </mat-icon>
                                          <label>Column Description</label>
                                          <input id="column_{{ column.id }}" matInput [(ngModel)]="column.name"
                                            class="anu-input" [ngModelOptions]="{
                                      standAlone: true
                                    }" />
                                        </mat-form-field>
                                        <p class="anu-input-plain" *ngIf="
                                    (currentClosure.canManage &&
                                      currentClosure.forGranteeUse) ||
                                    !currentClosure.canManage
                                  " style="background: #f0f1f0 !important">
                                          {{ column.name }}
                                        </p>
                                      </th>
                                    </ng-container>
                                  </ng-container>
                                </tr>
                                <ng-container *ngFor="
                            let row of attribute.fieldTableValue;
                            let i = index
                          ">
                                  <tr>
                                    <td style="
                                position: sticky;
                                width: 20%;
                                left: 0;
                                z-index: 1;
                                background: rgb(244, 244, 244);
                              ">
                                      <mat-form-field *ngIf="
                                  currentClosure.canManage &&
                                  !currentClosure.forGranteeUse
                                ">
                                        <mat-icon *ngIf="
                                    currentClosure.canManage &&
                                    !currentClosure.forGranteeUse
                                  " aria-hidden="false" style="
                                    font-size: 18px;
                                    top: 25px;
                                    position: relative;
                                    left: 90%;
                                    z-index: 1;
                                    cursor: pointer;
                                  " aria-label="Example home icon" inline="false" title="Delete this row">
                                          delete_outline
                                        </mat-icon>
                                        <label style="
                                    width: 100%;
                                    position: relative;
                                    text-align: center;
                                  ">Row Description</label>
                                        <textarea matInput [(ngModel)]="row.name" class="anu-input"
                                          style="height: 80px !important"
                                          [ngModelOptions]="{ standAlone: true }"></textarea>
                                      </mat-form-field>
                                      <p class="anu-input-plain" *ngIf="
                                  (currentClosure.canManage &&
                                    currentClosure.forGranteeUse) ||
                                  !currentClosure.canManage
                                " style="background: #f0f1f0 !important">
                                        {{ row.name }}
                                      </p>
                                    </td>
                                    <ng-container *ngFor="let column of row.columns">
                                      <td style="
                                  border: 1px solid #e4e4e4;
                                  min-width: 200px;
                                  padding-top: 0;
                                ">
                                        <mat-form-field>
                                          <input matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                      standAlone: true
                                    }" placeholder="Value" />
                                        </mat-form-field>
                                      </td>
                                    </ng-container>
                                  </tr>
                                </ng-container>
                              </table>
                            </div>
                            <div class="row">
                              <div class="col-12">
                                <span *ngIf="
                            currentClosure.canManage &&
                            !currentClosure.forGranteeUse
                          " style="cursor: pointer"><em class="fas fa-plus-circle text-green mr-1"></em>Add a
                                  row</span>
                              </div>
                            </div>
                          </div>
                          <div class="col-sm-12 col-lg-12 text-left" *ngIf="attribute.fieldType === 'disbursement'">
                            <div id="tableArea" #plannedProjectFundsModal role="dialog"
                              class="row modal mt-5 plannedProjectFundsModal"
                              style="padding-left: 15px; padding-right: 15px;margin-top: 100px;">
                              <span class="" style="position:absolute; right: 20px; left: auto;top: 10px;z-index:1;">
                                <mat-icon>close</mat-icon>
                              </span>
                              <p class="text-header">Planned Project Funds</p>
                              <table id="tablePlaceholderX" style="width:100%;">
                                <caption></caption>
                                <tr style="background: #f9f9f9">
                                  <th id="planned" style="border: 1px solid #e4e4e4;width:10%;">
                                    <label class="m-0"><span>Planned Installment #</span></label>
                                  </th>
                                  <ng-container *ngFor="
                              let column of getGrantDisbursementAttribute()
                                .fieldTableValue[0].columns;
                              let i = index
                            ">
                                    <th [id]="'col_1_'+i" [ngStyle]="
                                (column.name === 'Funds from other Sources')
                                  ? {
                                      border: '1px solid #e4e4e4',
                                      background: 'transparent',
                                      width:'10%'
                                    }
                                  : { border: '1px solid #e4e4e4',width:'10%' }
                              ">
                                      <label class="m-0 text-center p-2 m-0"
                                        style="font-weight: 400; font-size: 14px">{{
                                        column.name === "Notes"
                                        ? "Milestones/Notes"
                                        : column.name
                                        }}</label>
                                    </th>
                                  </ng-container>
                                </tr>
                                <ng-container *ngFor="
                            let row of getGrantDisbursementAttribute()
                              .fieldTableValue;
                            let i = index
                          ">
                                  <tr>
                                    <td style="width:10%;">
                                      <p class="anu-input m-0 text-center" style="background: #f4f4f4 !important">
                                        <label class="w-100 m-0">{{
                                          row.name
                                          }}</label>
                                      </p>
                                    </td>
                                    <ng-container *ngFor="
                                let column of row.columns;
                                let j = index
                              ">
                                      <td [ngStyle]="
                                  column.name === 'Notes' ? {width:'20%'} : {width:'12%'}
                                " [ngStyle]="
                                  column.name ===
                                  'Funds from other Sources'
                                    ? { background: 'transparent' }
                                    : {}
                                ">
                                        <p *ngIf="!column.dataType" class="anu-input m-0 w-100 m-0"
                                          style="background: #f4f4f4 !important">
                                          {{ column.value }}
                                        </p>
                                        <p *ngIf="column.dataType === 'currency'" class="anu-input w-100 text-right m-0"
                                          style="background: #f4f4f4 !important">
                                          {{ getFormattedCurrency(column.value) }}
                                        </p>
                                      </td>
                                    </ng-container>
                                  </tr>
                                </ng-container>
                                <tr
                                  [ngStyle]="getGrantDisbursementAttribute()
                                .fieldTableValue.length > 1?{background: '#f4f4f4'}:{background: '#f4f4f4',visibility:'hidden'}">
                                  <td class="py-2" style="position: sticky; left: 0; z-index: 1">
                                    <label class="w-100" style="font-weight: 600">TOTAL:</label>
                                  </td>
                                  <ng-container *ngIf="
                              getGrantDisbursementAttribute()
                                .fieldTableValue[0]
                            ">
                                    <td *ngFor="
                                let column of getGrantDisbursementAttribute()
                                  .fieldTableValue[0].columns;
                                let j = index
                              ">
                                      <label class="text-right pr-3 my-0 w-100"
                                        *ngIf="column.dataType === 'currency'"><strong class="pf">{{
                                          getTotals(
                                          j,
                                          getGrantDisbursementAttribute()
                                          .fieldTableValue
                                          )
                                          }}</strong></label>
                                    </td>
                                  </ng-container>
                                </tr>
                              </table>

                              <div id="tableArea" #receivedProjectFundsModal class="row dibursements-class"
                                style="padding-left: 15px; padding-right: 15px;">

                                <p class="text-header">Project Funds Received</p>
                                <table #dataColumns id="refunds-holder" class="refunds-holder" style="width:100%">
                                  <caption></caption>
                                  <ng-container *ngIf="!attribute.fieldTableValue">
                                    <tr>
                                      <th id="no_funds">
                                        <p>
                                          No funds have been recorded for this
                                          project yet
                                        </p>
                                      </th>
                                    </tr>
                                  </ng-container>
                                  <tr>
                                    <ng-container *ngIf="attribute.fieldTableValue">
                                      <td style="border: 1px solid #e4e4e4;width:10%;">
                                        <label class="m-0">#</label>
                                      </td>
                                    </ng-container>
                                    <ng-container *ngIf="
                              attribute.fieldTableValue &&
                              attribute.fieldTableValue[0]
                            ">
                                      <ng-container *ngFor="
                                let column of attribute.fieldTableValue[0]
                                  .columns;
                                let i = index
                              ">
                                        <td [ngStyle]="
                                  column.name ===
                                  'Funds from Other Sources'
                                    ? {
                                        border: '1px solid #e4e4e4',
                                        background: 'transparent',
                                        width:'10%'
                                      }
                                    : { border: '1px solid #e4e4e4',width:'10%' }
                                ">
                                          <label class="m-0 text-center p-2" style="
                                    font-weight: 400;
                                    font-size: 14px;
                                  ">{{
                                            column.name === "Notes"
                                            ? "Milestones/Notes"
                                            : column.name
                                            }}</label>
                                        </td>
                                      </ng-container>
                                    </ng-container>
                                  </tr>
                                  <ng-container *ngIf="
                            attribute.fieldTableValue &&
                            attribute.fieldTableValue.length > 0
                          ">
                                    <ng-container *ngFor="
                              let row of attribute.fieldTableValue;
                              let i = index
                            ">
                                      <tr *ngIf="row.reportId === currentClosure.id">
                                        <td [ngStyle]="
                                  row.enteredByGrantee
                                    ? {
                                        background: 'transparent',
                                        padding: '2px 4px',
                                        border: '1px solid #e4e4e4',
                                        width:'10%'
                                      }
                                    : {
                                        background: 'rgb(244,244,244)',
                                        padding: '2px 4px',
                                        border: '1px solid #e4e4e4',
                                        width:'10%'
                                      }
                                ">
                                          <mat-icon *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    row.enteredByGrantee
                                  " aria-hidden="false" style="
                                    font-size: 12px;
                                    top: -3px;
                                    position: relative;
                                    left: 88%;
                                    z-index: 1;
                                    cursor: pointer;
                                  " aria-label="Example home icon" inline="false" title="Delete this row">
                                            delete_outline
                                          </mat-icon>

                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    !currentClosure.forGranteeUse &&
                                    !row.enteredByGrantee
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    !currentClosure.forGranteeUse &&
                                    row.enteredByGrantee
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0px;
                                    ">
                                              <ng-container *ngIf="row.enteredByGrantee &&
                                  row.status && row.reportId===currentClosure.id">* </ng-container>
                                              <ng-container *ngIf="row.enteredByGrantee &&
                                  row.status && row.reportId!==currentClosure.id">** </ng-container>{{ row.name
                                              }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length ===
                                      1 && !currentClosure.forGranteeUse
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    !row.enteredByGrantee
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0px;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    row.enteredByGrantee &&
                                    row.status
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: -14px;
                                    ">
                                              <ng-container *ngIf="row.enteredByGrantee &&
                                  currentClosure.forGranteeUse &&
                                  row.status">* </ng-container>{{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    row.enteredByGrantee &&
                                    !row.status
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: -14px;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length ===
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    row.enteredByGrantee
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0px;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length ===
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    !row.enteredByGrantee
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0px;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                        </td>
                                        <ng-container *ngFor="
                                  let column of row.columns;
                                  let j = index
                                ">
                                          <td [ngStyle]="
                                    row.enteredByGrantee
                                      ? {
                                          border: '1px solid #e4e4e4',
                                          'padding-top': '0',
                                          background: 'transparent'
                                        }
                                      : {
                                          border: '1px solid #e4e4e4',
                                          'padding-top': '0'
                                        }
                                  " [ngStyle]="
                                    column.name === 'Notes'
                                      ? {background:'23%'}
                                      : {background:'12%'}
                                  ">
                                            <mat-form-field style="margin-top: 3px"
                                              *ngIf="!currentClosure.forGranteeUse">
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        !column.dataType &&
                                        !row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" disabled readonly style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        !column.dataType &&
                                        row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'date' &&
                                        !row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" disabled readonly style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources' &&
                                        !row.enteredByGrantee
                                      " #committedAmount type="number" matInput [(ngModel)]="column.value"
                                                class="anu-input text-right" disabled readonly style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources' &&
                                        !row.enteredByGrantee
                                      " #amountFormatted class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee
                                      " #committedAmount type="number" matInput [(ngModel)]="column.value"
                                                class="anu-input text-right" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee
                                      " #amountFormatted class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <input *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                            </mat-form-field>
                                            <mat-form-field style="margin-top: 3px"
                                              *ngIf="currentClosure.forGranteeUse">
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        !column.dataType &&
                                        !row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'date' &&
                                        !row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        !column.dataType &&
                                        row.enteredByGrantee &&
                                        row.status
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        !column.dataType &&
                                        row.enteredByGrantee &&
                                        !row.status
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee &&
                                        row.status
                                      " matInput [(ngModel)]="column.value" class="anu-input" readonly style="
                                        color: #212529;
                                        background: #ffffff !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee &&
                                        !row.status
                                      " matInput [(ngModel)]="column.value" class="anu-input" readonly style="
                                        color: #212529;
                                        background: #ffffff !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <mat-icon *ngIf="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee &&
                                        column.value !== '' &&
                                        column.value !== undefined
                                      " style="
                                        transform: scale(0.65);
                                        position: absolute;
                                        right: 15px;
                                        top: 21%;
                                        cursor: pointer;
                                        color: #7f7f7f;
                                      ">clear</mat-icon>
                                              <mat-icon *ngIf="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee
                                      " [ngStyle]="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee &&
                                        row.status &&
                                        column.value !== ''
                                          ? {
                                              transform: 'scale(0.55)',
                                              color: '#7f7f7f',
                                              position: 'absolute',
                                              right: '0',
                                              top: '21%',
                                              cursor: 'pointer'
                                            }
                                          : {
                                              transform: 'scale(0.55)',
                                              color: '#7f7f7f',
                                              position: 'absolute',
                                              right: '0',
                                              top: '21%',
                                              cursor: 'pointer'
                                            }
                                      ">calendar_today</mat-icon>
                                              <input *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        !row.enteredByGrantee
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        !row.enteredByGrantee
                                      " #amountFormatted class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee &&
                                        row.status
                                      " #amountFormatted class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee &&
                                        row.status
                                      " type="number" matInput [(ngModel)]="column.value"
                                                class="anu-input text-right" />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee &&
                                        !row.status
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <p [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee &&
                                        !row.status
                                      " type="number" class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                            </mat-form-field>
                                          </td>
                                        </ng-container>
                                      </tr>
                                      <!--When row belongs to a different report-->
                                      <tr *ngIf="row.reportId !== currentClosure.id">
                                        <td [ngStyle]="
                                  row.enteredByGrantee
                                    ? {
                                        background: 'transparent',
                                        padding: '2px 4px',
                                        border: '1px solid #e4e4e4',
                                        width:'10%'
                                      }
                                    : {
                                        background: 'rgb(244,244,244)',
                                        padding: '2px 4px',
                                        border: '1px solid #e4e4e4',
                                        width:'10%'
                                      }
                                ">
                                          <p class="anu-input m-0 text-center" [ngClass]="
                                    row.enteredByGrantee &&
                                    currentClosure.forGranteeUse &&
                                    row.status
                                      ? 'dark-grey-label'
                                      : 'light-grey-label'
                                  ">
                                            <ng-container *ngIf="row.enteredByGrantee &&
                                  currentClosure.forGranteeUse &&
                                  row.status && row.reportId===currentClosure.id">* </ng-container>
                                            <ng-container *ngIf="row.enteredByGrantee &&
                                  currentClosure.forGranteeUse &&
                                  row.status && row.reportId!==currentClosure.id">** </ng-container>{{ row.name
                                            }}
                                          </p>
                                        </td>
                                        <ng-container *ngFor="
                                  let column of row.columns;
                                  let j = index
                                ">
                                          <td [ngStyle]="
                                    row.enteredByGrantee
                                      ? {
                                          border: '1px solid #d6d6d6',
                                          'padding-top': '0',
                                          background: 'transparent'
                                        }
                                      : {
                                          border: '1px solid #e4e4e4',
                                          'padding-top': '0'
                                        }
                                  " [ngStyle]="
                                    column.name === 'Notes'
                                      ? {background:'23%'}
                                      : {background:'12%'}
                                  ">
                                            <mat-form-field style="margin-top: 3px"
                                              *ngIf="!currentClosure.forGranteeUse">
                                              <input [id]="'data_' + i + '_' + j" *ngIf="!column.dataType" matInput
                                                [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" disabled readonly style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />

                                              <input [id]="'data_' + i + '_' + j" *ngIf="column.dataType === 'date'"
                                                matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" disabled readonly style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />

                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " #committedAmount type="number" matInput [(ngModel)]="column.value"
                                                class="anu-input text-right" disabled readonly style="
                                        color: #212529;
                                        background: #d6d6d6 !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " #amountFormatted class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>

                                              <input *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                            </mat-form-field>
                                            <mat-form-field style="margin-top: 3px"
                                              *ngIf="currentClosure.forGranteeUse">
                                              <input [id]="'data_' + i + '_' + j" *ngIf="!column.dataType" matInput
                                                [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled [ngClass]="
                                        row.status
                                          ? 'dark-grey-input'
                                          : 'light-grey-input'
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="column.dataType === 'date'"
                                                matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled [ngClass]="
                                        row.status
                                          ? 'dark-grey-input'
                                          : 'light-grey-input'
                                      " />

                                              <input *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #d6d6d6 !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " class="anu-input w-100 text-right" [ngClass]="
                                        row.status?'dark-grey-label-abs':'light-grey-label-abs'
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #d6d6d6 !important;
                                      " />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " #amountFormatted class="anu-input w-100 text-right" [ngClass]="
                                      row.status?'dark-grey-label-abs':'light-grey-label-abs'
                                    ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                            </mat-form-field>
                                          </td>
                                        </ng-container>
                                      </tr>
                                    </ng-container>
                                  </ng-container>

                                  <div class="row">
                                    <div class="col-12">
                                    </div>
                                  </div>
                                  <tr *ngIf="
                            attribute.fieldTableValue
                            
                          " [ngStyle]="attribute.fieldTableValue.length > 1?{background: '#f4f4f4'}:{background: '#f4f4f4',visibility:'hidden'}">
                                    <td class="py-2" style="position: sticky; left: 0; z-index: 1">
                                      <label class="w-100" style="font-weight: 600">TOTAL:</label>
                                    </td>
                                    <ng-container *ngIf="attribute.fieldTableValue[0]">
                                      <td *ngFor="
                                let column of attribute.fieldTableValue[0]
                                  .columns;
                                let j = index
                              ">
                                        <label class="text-right pr-3 my-0 w-100"
                                          *ngIf="column.dataType === 'currency'"><strong class="rf">{{
                                            getTotals(j, attribute.fieldTableValue)
                                            }}</strong></label>
                                      </td>
                                    </ng-container>
                                  </tr>
                                </table>
                              </div>
                            </div>


                          </div>

                          <div class="col-sm-4 col-lg-8 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse
                    ">
                            <mat-form-field>
                              <input matInput disabled placeholder="Grant Level Target:"
                                style="background: #f0f1f0 !important" class="anu-input" [value]="
                          attribute.grantLevelTarget &&
                          attribute.grantLevelTarget !== null
                            ? attribute.grantLevelTarget
                            : 'N/A'
                        " />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-4 col-lg-8 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      currentClosure.canManage &&
                      currentClosure.forGranteeUse
                    ">
                            <mat-form-field>
                              <input matInput disabled placeholder="Grant Level Target:"
                                style="background: #f0f1f0 !important" class="anu-input" [value]="
                          attribute.grantLevelTarget &&
                          attribute.grantLevelTarget !== null
                            ? attribute.grantLevelTarget
                            : 'N/A'
                        " />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-4 col-lg-4 text-left" *ngIf="attribute.fieldType === 'kpi'">
                            <mat-form-field>
                              <input class="anu-input" matInput placeholder="Frequency:"
                                style="background: #f0f1f0 !important" [value]="
                          attribute.frequency === 'Half-yearly'
                            ? 'Half-Yearly'
                            : attribute.frequency === 'adhoc'
                            ? 'N/A'
                            : (attribute.frequency | titlecase)
                        " readonly disabled />
                            </mat-form-field>
                          </div>

                          <div class="col-sm-4 col-lg-4 text-left" *ngIf="attribute.fieldType === 'kpi'">
                            <mat-form-field>
                              <mat-label>Grant Level
                                Achieved<sup>&nbsp;(1)</sup>:</mat-label>
                              <input matInput style="background: #f0f1f0 !important" [value]="
                          attribute.cumulativeActuals
                            ? attribute.cumulativeActuals
                            : 'N/A'
                        " readonly disabled class="anu-input" />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      appComp.loggedInUser.organization
                        .organizationType === 'GRANTER' &&
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse
                    ">
                            <mat-form-field>
                              <input matInput [(ngModel)]="attribute.target" class="anu-input" type="number"
                                [ngModelOptions]="{ standAlone: true }" placeholder="Report Level Target:" />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      appComp.loggedInUser.organization
                        .organizationType === 'GRANTEE' &&
                      currentClosure.canManage &&
                      currentClosure.forGranteeUse
                    ">
                            <mat-form-field>
                              <input matInput placeholder="Report Level Target:" style="background: #f0f1f0 !important"
                                [value]="
                          attribute.target ? attribute.target : null
                        " readonly disabled class="anu-input" />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      
                      currentClosure.canManage &&
                      ((!currentClosure.forGranteeUse && isExternalGrant(currentClosure.grant)))
                    ">
                            <mat-form-field>
                              <input matInput placeholder="Report Level Accomplishment:" [value]="
                          attribute.actualTarget
                            ? attribute.actualTarget
                            : 'To be filled by implementing organization'
                        " readonly disabled style="background: #f0f1f0 !important" class="anu-input" />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      
                      currentClosure.canManage &&
                      ((currentClosure.forGranteeUse && isExternalGrant(currentClosure.grant)) || (!currentClosure.forGranteeUse && !isExternalGrant(currentClosure.grant)))
                    ">
                            <mat-form-field>
                              <input matInput [(ngModel)]="attribute.actualTarget" class="anu-input" type="number"
                                [ngModelOptions]="{ standAlone: true }" placeholder="Report Level Accomplishment:" />
                            </mat-form-field>
                          </div>
                          <div class="col-sm-12 col-lg-12 text-left" *ngIf="attribute.fieldType === 'multiline'">
                            <textarea [(ngModel)]="attribute.fieldValue" class="anu-input h-100 w-100"
                              [ngModelOptions]="{ standAlone: true }"></textarea>
                          </div>

                        </ng-container>
                        <div class="col-12" *ngIf="
                    currentClosure.canManage &&
                    !currentClosure.forGranteeUse
                  ">
                          <div class="row mt-3">
                            <div class="col-6 text-left" *ngIf="attribute.fieldType === 'kpi'">
                              <sup>(1) - Totals based on all approved reports for
                                grant</sup>
                            </div>
                            <div class="col-6 text-right" *ngIf="attribute.fieldType === 'kpi'">
                              <a [class]="i === 0 ? 'isDisabled' : ''">
                                <mat-icon style='color:#676767;'>keyboard_arrow_up</mat-icon>
                              </a>
                              <a [class]="
                          i === section.attributes.length - 1
                            ? 'isDisabled'
                            : ''
                        ">
                                <mat-icon style='color:#676767;'>keyboard_arrow_down</mat-icon>
                              </a>
                              <a><img alt="separator" src="./assets/img/Line.svg" class="w-10 mr-2"
                                  style="width: 1px" /></a>
                              <a href="javascript:">
                                <mat-icon style='color:#676767;'>delete_outlined</mat-icon>
                              </a>
                            </div>
                            <div class="col-12 text-right" *ngIf="attribute.fieldType !== 'kpi'">
                              <a [class]="i === 0 ? 'isDisabled' : ''">
                                <mat-icon style='color:#676767;'>keyboard_arrow_up</mat-icon>
                              </a>
                              <a [class]="
                          i === section.attributes.length - 1
                            ? 'isDisabled'
                            : ''
                        ">
                                <mat-icon style='color:#676767;'>keyboard_arrow_down</mat-icon>
                              </a>
                              <a><img alt="separator" src="./assets/img/Line.svg" class="w-10 mr-2"
                                  style="width: 1px" /></a>
                              <a href="javascript:">
                                <mat-icon style='color:#676767;'>delete_outlined</mat-icon>
                              </a>
                            </div>
                          </div>
                        </div>
                        <div class="col-12" *ngIf="
                    currentClosure.canManage && currentClosure.forGranteeUse
                  ">
                          <div class="row mt-3">
                            <div class="col-12 text-left" *ngIf="attribute.fieldType === 'kpi'">
                              <sup>(1) - Totals based on all approved reports for
                                grant</sup>
                            </div>
                          </div>
                        </div>
                      </div>
                    </ng-container>
                  </div>
                </ng-container>
              </div>
              <!-- SUMMARY END -->
              <div class="col-12">
                <ng-container *ngFor="let section of currentClosure.closureDetails.sections">
                  <hr />
                  <h5>
                    <span style="color: #929292; font-size: 13px; font-family: Roboto, sans-serif;">{{
                      section.sectionName.toLocaleUpperCase() }}</span>
                  </h5>

                  <div *ngIf="section.refund">
                    <div class="row mb-2 mt-2">
                      <div class="col-sm-12 col-lg-6 text-left mb-3 text-justify">
                        <span style="
                        color: #929292;
                        font-size: 15px;
                        font-family: Roboto, sans-serif;
                      ">{{ 'Refund Amount (₹)' }}</span>
                        <pre>{{getFormattedRefundAmount(currentClosure.grant.refundAmount)}}</pre>
                      </div>
                      <div class="col-sm-12 col-lg-6 text-left mb-3 text-justify">
                        <span style="
                        color: #929292;
                        font-size: 15px;
                        font-family: Roboto, sans-serif;
                      ">{{ 'Refund Reason' }}</span>
                        <pre>{{currentClosure.grant.refundReason}}</pre>
                      </div>
                      <div *ngIf="currentClosure.grant.actualRefunds && currentClosure.grant.actualRefunds.length>0"
                        class="col-sm-12 col-lg-12 text-left mb-3 text-justify">
                        <span style="
                        color: #929292;
                        font-size: 15px;
                        font-family: Roboto, sans-serif;
                      ">{{ 'Actual Refunds' }}</span>
                        <table border="1" style="width:100%;border:1px solid #3f3f3f;">
                          <caption></caption>
                          <tr>
                            <th id="">#</th>
                            <th id="">Refund Date</th>
                            <th id="">Refund Amount</th>
                            <th id="">Note</th>
                          </tr>
                          <tr *ngFor="let rf of currentClosure.grant.actualRefunds;let i=index">
                            <td>{{i+1}}</td>
                            <td>{{rf.refundDate | date : 'dd-MMM-yyyy'}}</td>
                            <td class="text-right">₹ {{rf.amount}}</td>
                            <td>{{rf.note}}</td>
                          </tr>
                        </table>
                      </div>

                      <ng-container *ngIf="currentClosure.closureDocuments && currentClosure.closureDocuments.length>0">
                        <div class="col-sm-12 col-lg-12 mb-3 mt-3">
                          <span style="
                          color: #929292;
                          font-size: 15px;
                          font-family: Roboto, sans-serif;
                        ">Associated Closure Documents</span>
                          <ul class="pl-0">
                            <li *ngFor="
                            let doc of currentClosure.closureDocuments
                          " style="list-style-type: none">
                              <p class="m-0" style="font-family: Roboto, sans-serif; font-size: 14px">
                                <strong>
                                  <ng-container *ngIf="doc.extension === 'pdf'">
                                    <em class="far fa-file-pdf text-danger ml-1"></em>
                                  </ng-container>
                                  <ng-container *ngIf="doc.extension === 'txt'">
                                    <em class="far fa-file-alt ml-1"></em>
                                  </ng-container>
                                  <ng-container *ngIf="
                                  doc.extension === 'xls' || doc.extension === 'xlsx'
                                ">
                                    <em class="far fa-file-excel text-success ml-1"></em>
                                  </ng-container>
                                  <ng-container *ngIf="
                                  doc.extension === 'doc' || doc.extension === 'docx'
                                ">
                                    <em class="far fa-file-word text-primary ml-1"></em>
                                  </ng-container>
                                  <ng-container *ngIf="
                                  doc.extension === 'ppt' || doc.extension === 'pptx'
                                ">
                                    <em class="far fa-file-powerpoint text-danger ml-1"></em>
                                  </ng-container>
                                  <span class="ml-2" style="cursor: pointer;" [matMenuTriggerFor]="menuDoc">{{
                                    doc.name}}</span>
                                  <div data-html2canvas-ignore="true">
                                    <mat-menu data-html2canvas-ignore #menuDoc="matMenu">
                                      <button mat-menu-item (click)="previewDocument('closure-document',doc)">
                                        <mat-icon class="ml-1">remove_red_eye</mat-icon>Preview
                                      </button>
                                      <button mat-menu-item (click)="downloadSingleClosureDoc(doc.id)">
                                        <mat-icon class="ml-1">file_download</mat-icon>Download
                                      </button>
                                    </mat-menu>
                                  </div>
                                </strong>
                              </p>
                            </li>
                          </ul>
                        </div>
                      </ng-container>
                    </div>
                  </div>

                  <div>
                    <div class="row mb-2 mt-2">
                      <ng-container *ngFor="let attribute of section.attributes">
                        <ng-container *ngIf="
                        attribute.fieldType === 'multiline' ||
                        attribute.fieldType === 'text'
                      " class="mb-2">
                          <div class="col-sm-12 col-lg-12 text-left mb-3 text-justify">
                            <span style="
                            color: #929292;
                            font-size: 13px;
                            font-family: Roboto, sans-serif;
                          ">{{ attribute.fieldName }}</span>
                            <pre
                              class="mt-1 text-justify"><strong><p style="font-size:14px;" [innerHtml]="attribute.fieldValue"></p></strong></pre>
                          </div>
                        </ng-container>

                        <ng-container *ngIf="attribute.fieldType === 'kpi'" class="mb-2">
                          <div class="col-sm-12 col-lg-12 text-left mb-3">
                            <table border="1">
                              <caption></caption>
                              <tr>
                                <th id="kpi" colspan="5" style="padding: 5px">KPI</th>
                              </tr>
                              <tr>
                                <td style="
                                padding: 5px;
                                font-size: 14px;
                                font-family: Roboto, sans-serif;
                              ">
                                  <strong>{{ attribute.fieldName }}</strong>
                                </td>
                                <td style="
                                font-size: 14px;
                                font-family: Roboto, sans-serif;
                                padding: 5px;
                              ">
                                  <table>
                                    <caption></caption>
                                    <tr>
                                      <th id="grant_level_goal_2">
                                        <span style="
                                        color: #929292;
                                        font-size: 13px;
                                        font-family: Roboto, sans-serif;
                                      ">Grant Level Goal:</span>
                                      </th>
                                    </tr>
                                    <tr>
                                      <td>
                                        <strong>{{
                                          !attribute.grantLevelTarget
                                          ? "Not Set"
                                          : attribute.grantLevelTarget
                                          }}</strong>
                                      </td>
                                    </tr>
                                  </table>
                                </td>
                                <td style="
                                font-size: 14px;
                                font-family: Roboto, sans-serif;
                                padding: 5px;
                              ">
                                  <table>
                                    <caption></caption>
                                    <tr>
                                      <th id="repror_level_goal">
                                        <span style="
                                        color: #929292;
                                        font-size: 13px;
                                        font-family: Roboto, sans-serif;
                                      ">Report Level Goal:</span>
                                      </th>
                                    </tr>
                                    <tr>
                                      <td>
                                        <strong>{{ attribute.target }}</strong>
                                      </td>
                                    </tr>
                                  </table>
                                </td>
                                <td style="
                                font-size: 14px;
                                font-family: Roboto, sans-serif;
                                padding: 5px;
                              ">
                                  <table>
                                    <caption></caption>
                                    <tr>
                                      <th id="actual_target">
                                        <span style="
                                        color: #929292;
                                        font-size: 13px;
                                        font-family: Roboto, sans-serif;
                                      ">Actual Goal Achieved:</span>
                                      </th>
                                    </tr>
                                    <tr>
                                      <td>
                                        <strong>{{ attribute.actualTarget }}</strong>
                                      </td>
                                    </tr>
                                  </table>
                                </td>
                                <td style="
                                font-size: 14px;
                                font-family: Roboto, sans-serif;
                                padding: 5px;
                              ">
                                  <table>
                                    <caption></caption>
                                    <tr>
                                      <th id="frequency_2">
                                        <span style="
                                        color: #929292;
                                        font-size: 13px;
                                        font-family: Roboto, sans-serif;
                                      ">Frequency:</span>
                                      </th>
                                    </tr>
                                    <tr>
                                      <td>
                                        <strong>{{
                                          attribute.frequency === "Half-yearly"
                                          ? "Half-Yearly"
                                          : attribute.frequency === "adhoc"
                                          ? "N/A"
                                          : (attribute.frequency | titlecase)
                                          }}</strong>
                                      </td>
                                    </tr>
                                  </table>
                                </td>
                              </tr>
                            </table>
                          </div>
                        </ng-container>
                        <ng-container *ngIf="attribute.fieldType === 'document'">
                          <div class="col-sm-12 col-lg-12 mb-3">
                            <span style="
                            color: #929292;
                            font-size: 13px;
                            font-family: Roboto, sans-serif;
                          ">{{ attribute.fieldName }}</span>
                            <ul class="pl-0">
                              <li *ngFor="
                              let doc of attribute.attachments
                            " style="list-style-type: none">
                                <p class="m-0" style="font-family: Roboto, sans-serif; font-size: 14px">
                                  <strong>
                                    <ng-container *ngIf="doc.type === 'pdf'">
                                      <em class="far fa-file-pdf text-danger ml-1"></em>
                                    </ng-container>
                                    <ng-container *ngIf="doc.type === 'txt'">
                                      <em class="far fa-file-alt ml-1"></em>
                                    </ng-container>
                                    <ng-container *ngIf="
                                    doc.type === 'xls' || doc.type === 'xlsx'
                                  ">
                                      <em class="far fa-file-excel text-success ml-1"></em>
                                    </ng-container>
                                    <ng-container *ngIf="
                                    doc.type === 'doc' || doc.type === 'docx'
                                  ">
                                      <em class="far fa-file-word text-primary ml-1"></em>
                                    </ng-container>
                                    <ng-container *ngIf="
                                    doc.type === 'ppt' || doc.type === 'pptx'
                                  ">
                                      <em class="far fa-file-powerpoint text-danger ml-1"></em>
                                    </ng-container>
                                    <span class="ml-2" style="cursor: pointer;" [matMenuTriggerFor]="menuDoc">{{
                                      doc.name +
                                      '.'+doc.type}}</span>
                                    <div data-html2canvas-ignore="true">
                                      <mat-menu data-html2canvas-ignore #menuDoc="matMenu">
                                        <button mat-menu-item (click)="previewDocument('closure',doc)">
                                          <mat-icon class="ml-1">remove_red_eye</mat-icon>Preview
                                        </button>
                                        <button mat-menu-item (click)="downloadSingleDoc(doc.id)">
                                          <mat-icon class="ml-1">file_download</mat-icon>Download
                                        </button>
                                      </mat-menu>
                                    </div>
                                  </strong>
                                </p>
                              </li>
                            </ul>
                          </div>
                        </ng-container>
                        <ng-container *ngIf="attribute.fieldType == 'table'">
                          <div class="col-sm-12 col-lg-12 mb-3">
                            <span style="
                            color: #929292;
                            font-size: 13px;
                            font-family: Roboto, sans-serif;
                          ">{{ attribute.fieldName }}</span>
                            <table border="1" class="mb-3" style="font-family: Roboto, sans-serif;">
                              <caption></caption>
                              <tr>
                                <th id="col_canton">&nbsp;</th>
                                <ng-container *ngIf="attribute.fieldTableValue[0]">
                                  <th id="'col_head_'+i" style="
                                  font-size: 14px;
                                  font-family: Roboto, sans-serif;
                                  padding: 5px;
                                  text-align: center;
                                " *ngFor="
                                  let col of attribute.fieldTableValue[0]
                                    .columns;let i=index
                                ">
                                    <strong>{{ col.name }}</strong>
                                  </th>
                                </ng-container>
                              </tr>
                              <tr *ngFor="let row of attribute.fieldTableValue">
                                <td style="
                                padding: 5px;
                                font-size: 14px;
                                font-family: Roboto, sans-serif;
                              ">
                                  <strong>{{ row.name }}</strong>
                                </td>
                                <td style="
                                padding: 5px;
                                font-size: 14px;
                                font-family: Roboto, sans-serif;
                              " *ngFor="let rowVal of row.columns">
                                  <strong>{{ rowVal.value }}</strong>
                                </td>
                              </tr>
                            </table>
                          </div>
                        </ng-container>

                        <div class="col-sm-12 col-lg-12 mb-3" *ngIf="attribute.fieldType == 'disbursement'">
                          <span style="
                          color: #929292;
                          font-size: 15px;
                          font-family: Roboto, sans-serif;
                        ">{{ attribute.fieldName }}</span>
                          <table border="1" class="mb-3" style="font-family: Roboto, sans-serif;">
                            <caption></caption>
                            <tr>
                              <ng-container *ngIf="attribute.fieldTableValue">
                                <th id="col#1" style="
                                padding: 5px;
                                font-size: 14px;
                                font-family: Roboto, sans-serif;
                              ">
                                  <strong>#</strong>
                                </th>
                              </ng-container>
                              <ng-container *ngIf="
                              attribute.fieldTableValue &&
                              attribute.fieldTableValue[0]
                            ">
                                <ng-container *ngFor="
                                let column of attribute.fieldTableValue[0]
                                  .columns;
                                let i = index
                              ">
                                  <th [id]="'col#2_'+i" class="pl-2" style="
                                  padding: 5px;
                                  font-size: 14px;
                                  font-family: Roboto, sans-serif;
                                ">
                                    <strong>{{
                                      column.name === "Notes"
                                      ? "Milestones/Notes"
                                      : column.name
                                      }}</strong>
                                  </th>
                                </ng-container>
                              </ng-container>
                            </tr>
                            <ng-container *ngIf="attribute.fieldTableValue">
                              <ng-container *ngFor="
                              let row of attribute.fieldTableValue;
                              let i = index
                            ">
                                <tr *ngIf="
                                (row.showForGrantee &&
                                  appComp.loggedInUser.organization
                                    .organizationType === 'GRANTEE') ||
                                appComp.loggedInUser.organization
                                  .organizationType === 'GRANTER'
                              ">
                                  <td style="
                                  padding: 5px;
                                  font-size: 14px;
                                  font-family: Roboto, sans-serif;
                                ">
                                    <ng-container *ngIf="row.enteredByGrantee &&
                              row.status && row.reportId===currentClosure.id">* </ng-container>
                                    <ng-container *ngIf="row.enteredByGrantee &&
                              row.status && row.reportId!==currentClosure.id">** </ng-container>{{ row.name }}
                                  </td>
                                  <ng-container *ngFor="
                                  let column of row.columns;
                                  let j = index
                                ">
                                    <td *ngIf="j === 1 || j === 2" style="
                                    min-width: 150px;
                                    padding: 5px;
                                    font-size: 14px;
                                    font-family: Roboto, sans-serif;
                                  ">
                                      <ng-container *ngIf="column.dataType === 'currency'">
                                        {{
                                        getFormattedCurrency(column.value)
                                        }}</ng-container>
                                    </td>
                                    <td *ngIf="
                                    j !== 1 &&
                                    j !== 2 &&
                                    column.name !== 'Notes'
                                  " style="
                                    padding: 5px;
                                    font-size: 14px;
                                    font-family: Roboto, sans-serif;
                                  ">
                                      <ng-container>{{
                                        column.value
                                        }}</ng-container>
                                    </td>
                                    <td *ngIf="
                                    j !== 1 &&
                                    j !== 2 &&
                                    column.name === 'Notes'
                                  " style="
                                    padding: 5px;
                                    font-size: 14px;
                                    font-family: Roboto, sans-serif;
                                  ">
                                      <ng-container>{{
                                        column.value
                                        }}</ng-container>
                                    </td>
                                  </ng-container>
                                </tr>
                              </ng-container>
                            </ng-container>
                            <ng-container *ngIf="attribute.fieldTableValue">
                              <tr *ngIf="
                              attribute.fieldTableValue.length > 1 ||
                              currentClosure.grant.approvedReportsDisbursements
                                .length > 1
                            " style="background: #f4f4f4">
                                <td style="
                                padding: 5px;
                                font-size: 14px;
                                font-family: Roboto, sans-serif;
                              ">
                                  <strong>Totals:</strong>
                                </td>
                                <ng-container *ngIf="attribute.fieldTableValue[0]">
                                  <td style="
                                  padding: 5px;
                                  font-size: 14px;
                                  font-family: Roboto, sans-serif;
                                " *ngFor="
                                  let column of attribute.fieldTableValue[0]
                                    .columns;
                                  let j = index
                                ">
                                    <strong *ngIf="column.dataType === 'currency'">{{
                                      getDisbursementTotals(
                                      j,
                                      attribute.fieldTableValue
                                      )
                                      }}</strong>
                                  </td>
                                </ng-container>
                              </tr>
                            </ng-container>
                            <tr *ngIf="showUnapprovedIndicator(attribute)">
                              <td colspan="5" [innerHTML]="showUnapprovedIndicator(attribute)"></td>
                            </tr>
                          </table>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </ng-container>
              </div>
            </div>
            <ng-template kendoPDFTemplate let-pageNum="pageNum" let-totalPages="totalPages">
              <div class="pageNum">Page {{ pageNum }} of {{ totalPages }}</div>
            </ng-template>
          </kendo-pdf-export>
        </div>
      </div>
    </div>
  </div>
</div>

<div #createSectionModal class="modal fade mt-5" id="createSectionModal" tabindex="-1" role="dialog"
  aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog center-class mt-5" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="createSectionLabel"></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="fieldTitleInput" class="mat-form-field-label pull-left">Section Name:</label>
          <input id="sectionTitleInput" class="form-control" value="" />
        </div>
        <div class="row px-3">
          <button type="button" class="btn btn-sm btn-green-primary" (click)="saveSection()">
            Done
          </button>
          <button type="button" class="btn btn-sm btn-green" data-dismiss="modal">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>