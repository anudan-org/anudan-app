<div class="col-12 bg-white" style="position: sticky; top: 80px; z-index: 1040">
  <div class="row">
    <ng-container *ngFor="let section of currentClosure.closureDetails.sections">
      <ng-container *ngIf="action === getCleanText(section)">
        <h4 class="col-11 text-left mt-3 mb-0 section-header">
          <p class="text-header d-flex align-items-center mb-0">Grant Closure <span class="text-subheader"> |
              {{
              (currentClosure.grant.referenceNo
              ? currentClosure.grant.referenceNo + " | "
              : "") + currentClosure.grant.name}}</span>
          </p>
          <p *ngIf="(currentClosure.grant.grantStatus.internalStatus === 'DRAFT' ||
          currentClosure.grant.grantStatus.internalStatus === 'REVIEW') &&
          currentClosure.grant.origGrantId" class="text-subheader d-flex align-items-center mb-0">
            <mat-icon [inline]="true" class="material-icons-outlined text-red mr-1">
              info_outline
            </mat-icon>
            <span>Amendment in-progress [<strong>{{ currentClosure.grant.origGrantRefNo }}</strong>]</span>
          </p>
        </h4>
        <h4 class="col-8 text-left my-3 section-header"
          [innerHTML]="section.systemGenerated?section.sectionName+'<sup class=sys-gen></sup>':section.sectionName">
        </h4>
        <div class="col-3" style="
              display: flex;
              align-items: center;
              justify-content: flex-end;
            ">
          <a *ngIf="currentClosure.canManage && !currentClosure.forGranteeUse"
            (click)="addNewFieldToSection(section.id, section.sectionName)" class="btn btn-sm btn-green">Add a Field<em
              class="fa fa-plus-square ml-2"></em></a>
        </div>
      </ng-container>
    </ng-container>
    <div class="col-1 text-right" style="display: flex; align-items: center; justify-content: flex-start">

      <mat-icon mat-button [matMenuTriggerFor]="menu" class="float-right" style="cursor: pointer">more_vert
      </mat-icon>
      <mat-menu #menu="matMenu">
        <ng-container *ngFor="let section of currentClosure.closureDetails.sections">
          <ng-container *ngIf="action === getCleanText(section)">
            <button *ngIf="currentClosure.canManage && !currentClosure.forGranteeUse" mat-menu-item
              (click)="editSection(section)">
              Edit Section name
            </button>
            <button *ngIf="currentClosure.canManage && !currentClosure.forGranteeUse" mat-menu-item (click)="
                  deleteSection(
                    section.id,
                    'Delete section ' + section.sectionName + '?'
                  )
                ">
              Delete Section
            </button>
            <hr>
            <button mat-menu-item (click)="showWorkflowAssigments()">
              <mat-icon class="ml-1">assignment</mat-icon>Manage Assignments
            </button>
            <button mat-menu-item (click)="showHistory('grant-closure', currentClosure)">
              <mat-icon class="ml-1">comment</mat-icon>View Notes
            </button>
            <ng-container>
              <hr />
              <button mat-menu-item (click)="manageGrant()">
                <img alt="View Grant Link" class="ml-2 mr-3" style="width: 20px; height: 20px"
                  src="./assets/img/dp.svg" />View Grant
              </button>
            </ng-container>
          </ng-container>
        </ng-container>
      </mat-menu>
    </div>
  </div>
</div>
<div class="main-content no-top-margin2" style="margin-top: 40px;">
  <div class="container-fluid anudan-scrollable" style="background: #fff;">
    <div class="row anu-container">

      <div class="col-lg-12">
        <div #container class="container text-left mt-2 px-3 py-2">
          <div *ngIf="currentClosure.canManage">
            <mat-form-field style="height: 0">
              <input matInput [matDatepicker]="datePicker" (dateInput)="setDate($event)"
                [matDatepickerFilter]="dateFilter" />
              <mat-datepicker #datePicker></mat-datepicker>
            </mat-form-field>
            <mat-form-field style="height: 0">
              <input matInput [matDatepicker]="datePicker2" (dateInput)="setARDate($event)"
                [matDatepickerFilter]="dateFilter" />
              <mat-datepicker #datePicker2></mat-datepicker>
            </mat-form-field>
            <div class="row">
              <div class="col-12">
                <ng-container *ngIf="action==='ProjectRefundDetails'">
                  <div>
                    <ng-container>
                      <div class="row mb-4 mt-2" style="
                border: 1px solid #ececec;
                border-radius: 4px;
                padding: 20px;
                background: #fcfcfc;
              ">
                        <ng-container class="mb-2">
                          <div class="col-5">
                            <mat-form-field style="max-width: 190px;">
                              <mat-label>Requested Refund Amount (â‚¹)</mat-label>
                              <input matInput (blur)="showFormattedRefundAmount($event)" #refundAmount
                                [(ngModel)]="currentClosure.grant.refundAmount" class="anu-input"
                                [ngModelOptions]="{ standAlone: true }" matInput />
                              <p *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTER'"
                                #grantRefundFormatted (click)="showRefundAmountInput($event)"
                                class="anu-input w-100 text-right" style="position: absolute; top: 5px; cursor: text"
                                [innerHtml]="getFormattedRefundAmount(currentClosure.grant.refundAmount)"></p>
                              <p *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTEE'"
                                #grantRefundFormatted class="anu-input w-100 text-right"
                                style="position: absolute; top: 5px; background:#e6e6e6 !important;"
                                [innerHtml]="getFormattedRefundAmount(currentClosure.grant.refundAmount)"></p>
                            </mat-form-field>

                            <span class="text-subheader" style="position: absolute; bottom: 0px; ">Unspent Amount:
                              {{unspentAmount}}</span>
                             </div>
                        </ng-container>
                        <ng-container class="mb-2">
                          <div class="col-7">
                            <mat-form-field *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTER'">
                              <mat-label for="rn">Refund Request Note</mat-label>
                              <input id="rn" matInput [(ngModel)]="currentClosure.grant.refundReason" class="anu-input"
                                [ngModelOptions]="{ standAlone: true }" matInput placeholder="Enter Refund Note" />

                            </mat-form-field>
                            <label class="mat-form-field-label-wrapper"
                              style="font-weight: normal; font-family: Lato; color: rgba(0,0,0,0.5);"
                              *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTEE'">Refund
                              Note</label>
                            <p *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTEE'" class="anu-input"
                              style="background: #e6e6e6 !important; position: absolute; top: 18px; width: 100%; left: 0;">
                              {{currentClosure.grant.refundReason}}
                            </p>
                          </div>
                        </ng-container>
                        <ng-container>
                          <div class="col-12 pt-4">
                            <div class="row">
                              <div class="col-12">
                                <p class="text-header px-0">Actual Refunds</p>
                              </div>
                              <ng-container *ngIf="currentClosure.grant.actualRefunds.length>0">
                                <div class="row refunds-holder mx-3">
                                  <div class="col-1 text-header text-center py-1" style="border:0px solid #d4d4d4;">#
                                  </div>
                                  <div class="col-3 text-right text-header py-1" style="border:0px solid #d4d4d4;">
                                    Refund Date</div>
                                  <div class="col-3 text-right text-header py-1" style="border:0px solid #d4d4d4;">
                                    Refunded Amount</div>
                                  <div class="col-5 text-left text-header py-1" style="border:0px solid #d4d4d4;">
                                    Refund Note</div>
                                  <ng-container *ngFor="let af of currentClosure.grant.actualRefunds;let i=index">
                                    <div class="col-1 py-1"
                                      style="border:0px solid #d4d4d4;display:flex;align-items:center;justify-content:center;">
                                      {{i+1}}
                                      <mat-icon
                                        *ngIf="currentClosure.grant.actualRefunds.length > 1 && appComp.loggedInUser.organization.organizationType==='GRANTER'"
                                        (click)="deleteActualRefundRow(af, i)" aria-hidden="false"
                                        style="font-size: 12px; top: 38%; position: absolute; right: 9px; z-index: 1; cursor: pointer; width: auto; height: auto;"
                                        aria-label="Example home icon" inline="false" title="Delete this row">
                                        delete_outline
                                      </mat-icon>
                                    </div>
                                    <div class="col-3 py-1" style="border:0px solid #d4d4d4;">
                                      <mat-form-field>
                                        <input *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTER'"
                                          (click)='openARDate(af,$event)' [value]="getRedundDate(af.refundDate)"
                                          class="anu-input text-center" [ngModel]="af.refundDate | date: 'dd-MMM-yyyy'"
                                          [ngModelOptions]="{ standAlone: true }" matInput placeholder="" readonly />
                                        <input *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTEE'"
                                          [value]="getRedundDate(af.refundDate)" class="anu-input text-center"
                                          [ngModel]="af.refundDate | date: 'dd-MMM-yyyy'"
                                          [ngModelOptions]="{ standAlone: true }" matInput placeholder="" readonly
                                          style="background:#e6e6e6 !important;" />
                                        <mat-icon *ngIf="
                                        af.refundDate !== undefined &&
                                        af.refundDate !== null && appComp.loggedInUser.organization.organizationType==='GRANTER'
                        " (click)="clearRowDate(af,i)" style="
                          transform: scale(0.65);
                          position: absolute;
                          right: 0;
                          top: 20%;
                          cursor: pointer;
                          color: #7f7f7f;
                        ">clear</mat-icon>
                                        <mat-icon (click)="openARDate(af,$event)" [ngStyle]="
                                        af.refundDate !== undefined &&
                                        af.refundDate !== null && appComp.loggedInUser.organization.organizationType==='GRANTER'
                            ? {
                                transform: 'scale(0.55)',
                                color: '#7f7f7f',
                                position: 'absolute',
                                right: '16px',
                                top: '20%',
                                cursor: 'pointer'
                              }
                            : {
                                transform: 'scale(0.55)',
                                color: '#7f7f7f',
                                position: 'absolute',
                                right: '0',
                                top: '27%',
                                cursor: 'pointer'
                              }
                        ">calendar_today</mat-icon>
                                      </mat-form-field>
                                    </div>
                                    <div class="col-3 py-1" style="border:0px solid #d4d4d4;">
                                      <mat-form-field>
                                        <p *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTER'"
                                          [id]="'afp_'+af.id" (click)="toggleARAmountInput($event)"
                                          class="anu-input text-right"
                                          style="position: absolute; height: 100%; width: 100%; margin: 0; visibility: visible;">
                                          {{getFormattedARAmount(af.amount)}}</p>
                                        <input *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTER'"
                                          style="visibility: hidden;" [id]="'afinput_'+af.id" type="number"
                                          (blur)="toggleARInput($event,af)" [(ngModel)]="af.amount" class="anu-input"
                                          [ngModelOptions]="{ standAlone: true }" matInput placeholder="" />
                                        <input *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTEE'"
                                          disabled [id]="'afinput_'+af.id" type="text"
                                          [value]="currencyService.getFormattedAmount(af.amount)"
                                          class="anu-input text-right" style="background:#e6e6e6 !important;"
                                          [ngModelOptions]="{ standAlone: true }" matInput placeholder="" />

                                      </mat-form-field>
                                    </div>
                                    <div class="col-5 py-1" style="border:0px solid #d4d4d4;">
                                      <mat-form-field>
                                        <input *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTER'"
                                          [(ngModel)]="af.note" class="anu-input" (blur)="updateRefundLineItem(af)"
                                          [ngModelOptions]="{ standAlone: true }" matInput placeholder="" />
                                        <input *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTEE'"
                                          disabled [(ngModel)]="af.note" class="anu-input"
                                          (blur)="updateRefundLineItem(af)" [ngModelOptions]="{ standAlone: true }"
                                          matInput placeholder="" style="background:#e6e6e6 !important;" />
                                      </mat-form-field>
                                    </div>
                                  </ng-container>
                                  <ng-container *ngIf="currentClosure.grant.actualRefunds.length>1">
                                    <div class="col-1" style="border:0px solid #d4d4d4;"><strong>Totals</strong></div>
                                    <div class="col-3" style="border:0px solid #d4d4d4;"></div>
                                    <div class="col-3 text-right pr-4" style="border:0px solid #d4d4d4;">
                                      {{getActualRefundsTotal()}}
                                    </div>
                                    <div class="col-5" style="border:0px solid #d4d4d4;"></div>
                                  </ng-container>
                                </div>
                              </ng-container>
                              <div *ngIf="appComp.loggedInUser.organization.organizationType==='GRANTER'"
                                class="col-12">
                                <span (click)="addActualRefunds()" style="cursor: pointer"><em
                                    class="fas fa-plus-circle text-green mr-1"></em>Add a row</span>
                              </div>
                              <!-- PLACE WHERE WE HAD THE CLOSURE DOCS-->
                            </div>
                          </div>

                        </ng-container>
                      </div>
                    </ng-container>
                  </div>
                </ng-container>
                <ng-container *ngFor="let section of currentClosure.closureDetails.sections">
                  <div *ngIf="action === getCleanText(section)">
                    <div>
                      <ng-container #sectionsContainer *ngFor="let attribute of section.attributes; let i = index">
                        <div id="fieldBlock_{{ attribute.id }}" class="row mb-4 mt-2" style="
                  border: 1px solid #ececec;
                  border-radius: 4px;
                  padding: 20px;
                  background: #fcfcfc;
                ">
                          <ng-container class="mb-2">
                            <div class="col-sm-4 col-lg-8" *ngIf="
                      attribute.fieldType === 'multiline' &&
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse
                    ">
                              <mat-form-field>
                                <input id="field_{{ attribute.id }}" [(ngModel)]="attribute.fieldName" class="anu-input"
                                  [ngModelOptions]="{ standAlone: true }" matInput placeholder="Title" />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-lg-8" *ngIf="
                      attribute.fieldType === 'multiline' &&
                      currentClosure.canManage &&
                      currentClosure.forGranteeUse
                    ">

                              <label>Title:</label>
                              <p>{{ attribute.fieldName }}</p>
                            </div>
                            <div class="col-sm-4 col-lg-8" *ngIf="attribute.fieldType === 'document'">
                              <mat-form-field *ngIf="
                        currentClosure.canManage &&
                        !currentClosure.forGranteeUse
                      ">

                                <input id="field_{{ attribute.id }}" [(ngModel)]="attribute.fieldName" class="anu-input"
                                  [ngModelOptions]="{ standAlone: true }" matInput placeholder="Title" />
                              </mat-form-field>
                              <label *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      ">Title:</label>
                              <p class="anu-input" *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      " style="background: #f0f1f0 !important">
                                {{ attribute.fieldName }}
                              </p>
                            </div>
                            <div class="col-sm-4 col-lg-8" *ngIf="attribute.fieldType === 'text'">
                              <mat-form-field>
                                <input id="field_{{ attribute.id }}" [(ngModel)]="attribute.fieldName" class="anu-input"
                                  [ngModelOptions]="{ standAlone: true }" matInput placeholder="Title" />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-8 col-lg-8" *ngIf="attribute.fieldType === 'table'">
                              <mat-form-field *ngIf="
                        currentClosure.canManage &&
                        !currentClosure.forGranteeUse
                      ">
                                <input id="field_{{ attribute.id }}" [(ngModel)]="attribute.fieldName" class="anu-input"
                                  [ngModelOptions]="{ standAlone: true }" matInput placeholder="Title" />
                              </mat-form-field>
                              <label *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      ">Title:</label>
                              <p class="anu-input" *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      " style="background: #f0f1f0 !important">
                                {{ attribute.fieldName }}
                              </p>
                            </div>

                            <div *ngIf="attribute.fieldType === 'disbursement'" class="col-12 mb-3">

                            </div>
                            <div class="col-sm-4 col-lg-8" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse &&
                      attribute.canEdit
                    ">
                              <mat-form-field>
                                <input [(ngModel)]="attribute.fieldName" class="anu-input"
                                  [ngModelOptions]="{ standAlone: true }" matInput placeholder="Title" />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-lg-8" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse &&
                      !attribute.canEdit
                    ">
                              <mat-form-field>
                                <input [(ngModel)]="attribute.fieldName" class="anu-input"
                                  [ngModelOptions]="{ standAlone: true }" disabled readonly
                                  style="background: #f0f1f0 !important" matInput placeholder="Title" />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-lg-8" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      currentClosure.canManage &&
                      currentClosure.forGranteeUse
                    ">
                              <mat-form-field>
                                <input [(ngModel)]="attribute.fieldName" class="anu-input"
                                  [ngModelOptions]="{ standAlone: true }" readonly disabled
                                  style="background: #f0f1f0 !important" matInput placeholder="Title" />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse &&
                      attribute.canEdit
                    ">
                              <mat-form-field *ngIf="attribute.fieldType!=='disbursement'">
                                <mat-label>Type</mat-label>
                                <mat-select [disabled]="attribute.fieldType==='disbursement'" (selectionChange)="
                handleTypeChange($event, attribute, section)
              " [ngModel]="attribute.fieldType" class="anu-input" [ngModelOptions]="{ standAlone: true }">
                                  <mat-option value="multiline">Descriptive</mat-option>
                                  <mat-option value="kpi">Measurement/KPI</mat-option>
                                  <mat-option value="table">Tablular</mat-option>
                                  <mat-option value="document">Document</mat-option>
                                  <mat-option value="disbursement" [disabled]="checkAbilityToAddDisbursements()">
                                    Disbursement</mat-option>
                                </mat-select>
                              </mat-form-field>
                              <label *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      ">Type:</label>
                              <p class="anu-input" *ngIf="
                        (currentClosure.canManage &&
                          currentClosure.forGranteeUse) ||
                        !currentClosure.canManage
                      " style="background: #f0f1f0 !important">
                                {{ getFieldTypeDisplayValue(attribute.fieldType) }}
                              </p>
                            </div>

                            <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse &&
                      !attribute.canEdit
                    ">
                              <mat-form-field>
                                <input matInput placeholder="Type:" disabled readonly class="anu-input"
                                  style="background: #f0f1f0 !important" [value]="
                          getFieldTypeDisplayValue(attribute.fieldType)
                        " />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      currentClosure.canManage &&
                      currentClosure.forGranteeUse
                    ">
                              <mat-form-field>
                                <input matInput placeholder="Type:" disabled readonly class="anu-input"
                                  style="background: #f0f1f0 !important" [value]="
                          getFieldTypeDisplayValue(attribute.fieldType)
                        " />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-3 col-lg-3 text-left" *ngIf="attribute.fieldType === 'text'">
                              <mat-form-field>
                                <input matInput [(ngModel)]="attribute.fieldValue" class="anu-input"
                                  [ngModelOptions]="{ standAlone: true }" placeholder="Field Value" />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-12 col-lg-11 text-left" *ngIf="attribute.fieldType === 'table'">
                              <div class="row">
                                <div class="col-12 text-right">
                                  <span *ngIf="
                            currentClosure.canManage &&
                            !currentClosure.forGranteeUse
                          " (click)="addColumn(attribute)" style="cursor: pointer"><em
                                      class="fas fa-plus-circle text-green mr-1"></em>Add a column</span>
                                </div>
                                <div style="margin-left: 250px">
                                  <em (click)="moveColsRight()" class="fas fa-arrow-alt-circle-left mr-3"></em><em
                                    (click)="moveColsLeft()" class="fas fa-arrow-alt-circle-right"></em>
                                </div>
                              </div>
                              <div id="tableArea" class="row flex-row flex-nowrap"
                                style="overflow: hidden; overflow-x: scroll">
                                <table id="tablePlaceholderX" class='refunds-holder'>
                                  <caption></caption>
                                  <tr>
                                    <th id="col1" style="
                              min-width: 250px;width:20%;
                              position: sticky;
                              left: 0;
                              z-index: 1;
                              background: rgb(244, 244, 244);
                            ">
                                      &nbsp;
                                    </th>
                                    <ng-container *ngIf="attribute.fieldTableValue[0]">
                                      <ng-container *ngFor="
                                let column of attribute.fieldTableValue[0]
                                  .columns;
                                let i = index
                              ">
                                        <th [id]="'col_'+i" style="border: 1px solid #e4e4e4">
                                          <mat-form-field *ngIf="
                                    currentClosure.canManage &&
                                    !currentClosure.forGranteeUse
                                  ">
                                            <mat-icon *ngIf="
                                      currentClosure.canManage &&
                                      !currentClosure.forGranteeUse
                                    " (click)="
                                      deleteColumn(
                                        section.id,
                                        attribute.id,
                                        i
                                      )
                                    " aria-hidden="false" style="
                                      font-size: 18px;
                                      position: relative;
                                      left: 90%;
                                      z-index: 0;
                                      cursor: pointer;
                                      top: 3px;
                                    " aria-label="Example home icon" inline="false" title="Delete this column">
                                              delete_outline
                                            </mat-icon>
                                            <label>Column Description</label>
                                            <input id="column_{{ column.id }}" matInput [(ngModel)]="column.name"
                                              class="anu-input" [ngModelOptions]="{
                                      standAlone: true
                                    }" />
                                          </mat-form-field>
                                          <p class="anu-input-plain" *ngIf="
                                    (currentClosure.canManage &&
                                      currentClosure.forGranteeUse) ||
                                    !currentClosure.canManage
                                  " style="background: #f0f1f0 !important">
                                            {{ column.name }}
                                          </p>
                                        </th>
                                      </ng-container>
                                    </ng-container>
                                  </tr>
                                  <ng-container *ngFor="
                            let row of attribute.fieldTableValue;
                            let i = index
                          ">
                                    <tr>
                                      <td style="
                                position: sticky;
                                width: 20%;
                                left: 0;
                                z-index: 1;
                                background: rgb(244, 244, 244);
                              ">
                                        <mat-form-field *ngIf="
                                  currentClosure.canManage &&
                                  !currentClosure.forGranteeUse
                                ">
                                          <mat-icon *ngIf="
                                    currentClosure.canManage &&
                                    !currentClosure.forGranteeUse
                                  " (click)="
                                    deleteRow(section.id, attribute.id, i)
                                  " aria-hidden="false" style="
                                    font-size: 18px;
                                    top: 25px;
                                    position: relative;
                                    left: 90%;
                                    z-index: 1;
                                    cursor: pointer;
                                  " aria-label="Example home icon" inline="false" title="Delete this row">
                                            delete_outline
                                          </mat-icon>
                                          <label style="
                                    width: 100%;
                                    position: relative;
                                    text-align: center;
                                  ">Row Description</label>
                                          <textarea matInput [(ngModel)]="row.name" class="anu-input"
                                            style="height: 80px !important"
                                            [ngModelOptions]="{ standAlone: true }"></textarea>
                                        </mat-form-field>
                                        <p class="anu-input-plain" *ngIf="
                                  (currentClosure.canManage &&
                                    currentClosure.forGranteeUse) ||
                                  !currentClosure.canManage
                                " style="background: #f0f1f0 !important">
                                          {{ row.name }}
                                        </p>
                                      </td>
                                      <ng-container *ngFor="let column of row.columns">
                                        <td style="
                                  border: 1px solid #e4e4e4;
                                  min-width: 200px;
                                  padding-top: 0;
                                ">
                                          <mat-form-field>
                                            <input matInput [(ngModel)]="column.value" class="anu-input"
                                              [ngModelOptions]="{
                                      standAlone: true
                                    }" placeholder="Value" />
                                          </mat-form-field>
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </ng-container>
                                </table>
                              </div>
                              <div class="row">
                                <div class="col-12">
                                  <span *ngIf="
                            currentClosure.canManage &&
                            !currentClosure.forGranteeUse
                          " (click)="addRow(attribute)" style="cursor: pointer"><em
                                      class="fas fa-plus-circle text-green mr-1"></em>Add a row</span>
                                </div>
                              </div>
                            </div>
                            <div class="col-sm-12 col-lg-12 text-left" *ngIf="attribute.fieldType === 'disbursement'">
                              <div id="tableArea" class="row" style="padding-left: 15px; padding-right: 15px">
                                <p class="text-header">Planned Project Funds</p>
                                <table id="tablePlaceholderX" style="width:100%;">
                                  <caption></caption>
                                  <tr style="background: #f9f9f9">
                                    <th id="planned" style="border: 1px solid #e4e4e4;width:10%;">
                                      <label class="m-0"><span>Planned Installment #</span></label>
                                    </th>
                                    <ng-container *ngFor="
                              let column of getGrantDisbursementAttribute()
                                .fieldTableValue[0].columns;
                              let i = index
                            ">
                                      <th [id]="'col_1_'+i" [ngStyle]="
                                (column.name === 'Funds from other Sources')
                                  ? {
                                      border: '1px solid #e4e4e4',
                                      background: 'transparent',
                                      width:'10%'
                                    }
                                  : { border: '1px solid #e4e4e4',width:'10%' }
                              ">
                                        <label class="m-0 text-center p-2 m-0"
                                          style="font-weight: 400; font-size: 14px">{{
                                          column.name === "Notes"
                                          ? "Milestones/Notes"
                                          : column.name
                                          }}</label>
                                      </th>
                                    </ng-container>
                                  </tr>
                                  <ng-container *ngFor="
                            let row of getGrantDisbursementAttribute()
                              .fieldTableValue;
                            let i = index
                          ">
                                    <tr>
                                      <td style="width:10%;">
                                        <p class="anu-input m-0 text-center" style="background: #f4f4f4 !important">
                                          <label class="w-100 m-0">{{
                                            row.name
                                            }}</label>
                                        </p>
                                      </td>
                                      <ng-container *ngFor="
                                let column of row.columns;
                                let j = index
                              ">
                                        <td [ngStyle]="
                                  column.name === 'Notes' ? {width:'20%'} : {width:'12%'}
                                " [ngStyle]="
                                  column.name ===
                                  'Funds from other Sources'
                                    ? { background: 'transparent' }
                                    : {}
                                ">
                                          <p *ngIf="!column.dataType" class="anu-input m-0 w-100 m-0"
                                            style="background: #f4f4f4 !important">
                                            {{ column.value }}
                                          </p>
                                          <p *ngIf="column.dataType === 'currency'"
                                            class="anu-input w-100 text-right m-0"
                                            style="background: #f4f4f4 !important">
                                            {{ getFormattedCurrency(column.value) }}
                                          </p>
                                        </td>
                                      </ng-container>
                                    </tr>
                                  </ng-container>
                                  <tr
                                    [ngStyle]="getGrantDisbursementAttribute()
                                  .fieldTableValue.length > 1?{background: '#f4f4f4'}:{background: '#f4f4f4',visibility:'hidden'}">
                                    <td class="py-2" style="position: sticky; left: 0; z-index: 1">
                                      <label class="w-100" style="font-weight: 600">TOTAL:</label>
                                    </td>
                                    <ng-container *ngIf="
                              getGrantDisbursementAttribute()
                                .fieldTableValue[0]
                            ">
                                      <td *ngFor="
                                let column of getGrantDisbursementAttribute()
                                  .fieldTableValue[0].columns;
                                let j = index
                              ">
                                        <label class="text-right pr-3 my-0 w-100"
                                          *ngIf="column.dataType === 'currency'"><strong class="pf">{{
                                            getTotals(
                                            j,
                                            getGrantDisbursementAttribute()
                                            .fieldTableValue
                                            )
                                            }}</strong></label>
                                      </td>
                                    </ng-container>
                                  </tr>
                                </table>
                              </div>

                              <div id="tableArea" class="row dibursements-class mt-4"
                                style="padding-left: 15px; padding-right: 15px">
                                <p class="text-header">Project Funds Received</p>
                                <table #dataColumns id="refunds-holder" class="refunds-holder" style="width:100%">
                                  <caption></caption>
                                  <ng-container *ngIf="!attribute.fieldTableValue">
                                    <tr>
                                      <th id="no_funds">
                                        <p>
                                          No funds have been recorded for this
                                          project yet
                                        </p>
                                      </th>
                                    </tr>
                                  </ng-container>
                                  <tr>
                                    <ng-container *ngIf="attribute.fieldTableValue">
                                      <td style="border: 1px solid #e4e4e4;width:10%;">
                                        <label class="m-0">#</label>
                                      </td>
                                    </ng-container>
                                    <ng-container *ngIf="
                              attribute.fieldTableValue &&
                              attribute.fieldTableValue[0]
                            ">
                                      <ng-container *ngFor="
                                let column of attribute.fieldTableValue[0]
                                  .columns;
                                let i = index
                              ">
                                        <td [ngStyle]="
                                  column.name ===
                                  'Funds from Other Sources'
                                    ? {
                                        border: '1px solid #e4e4e4',
                                        background: 'transparent',
                                        width:'10%'
                                      }
                                    : { border: '1px solid #e4e4e4',width:'10%' }
                                ">
                                          <label class="m-0 text-center p-2" style="
                                    font-weight: 400;
                                    font-size: 14px;
                                  ">{{
                                            column.name === "Notes"
                                            ? "Milestones/Notes"
                                            : column.name
                                            }}</label>
                                        </td>
                                      </ng-container>
                                    </ng-container>
                                  </tr>
                                  <ng-container *ngIf="
                            attribute.fieldTableValue &&
                            attribute.fieldTableValue.length > 0
                          ">
                                    <ng-container *ngFor="
                              let row of attribute.fieldTableValue;
                              let i = index
                            ">
                                      <tr *ngIf="row.reportId === currentClosure.id">
                                        <td [ngStyle]="
                                  row.enteredByGrantee
                                    ? {
                                        background: 'transparent',
                                        padding: '2px 4px',
                                        border: '1px solid #e4e4e4',
                                        width:'10%'
                                      }
                                    : {
                                        background: 'rgb(244,244,244)',
                                        padding: '2px 4px',
                                        border: '1px solid #e4e4e4',
                                        width:'10%'
                                      }
                                ">
                                          <mat-icon *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    row.enteredByGrantee
                                  " aria-hidden="false" style="
                                    font-size: 12px;
                                    top: -3px;
                                    position: relative;
                                    left: 88%;
                                    z-index: 1;
                                    cursor: pointer;
                                  " aria-label="Example home icon" inline="false" title="Delete this row">
                                            delete_outline
                                          </mat-icon>

                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    !currentClosure.forGranteeUse &&
                                    !row.enteredByGrantee
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    !currentClosure.forGranteeUse &&
                                    row.enteredByGrantee
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0px;
                                    ">
                                              <ng-container *ngIf="row.enteredByGrantee &&
                                  row.status && row.reportId===currentClosure.id">* </ng-container>
                                              <ng-container *ngIf="row.enteredByGrantee &&
                                  row.status && row.reportId!==currentClosure.id">** </ng-container>{{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length ===
                                      1 && !currentClosure.forGranteeUse
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    !row.enteredByGrantee
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0px;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    row.enteredByGrantee &&
                                    row.status
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: -14px;
                                    ">
                                              <ng-container *ngIf="row.enteredByGrantee &&
                                  currentClosure.forGranteeUse &&
                                  row.status">* </ng-container>{{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length >
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    row.enteredByGrantee &&
                                    !row.status
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: -14px;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length ===
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    row.enteredByGrantee
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0px;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                          <ng-container *ngIf="
                                    attribute.fieldTableValue.length ===
                                      1 &&
                                    currentClosure.forGranteeUse &&
                                    !row.enteredByGrantee
                                  ">
                                            <p class="anu-input m-0 text-center" style="
                                      background: #f4f4f4 !important;
                                      position: relative;
                                      top: 0px;
                                    ">
                                              {{ row.name }}
                                            </p>
                                          </ng-container>
                                        </td>
                                        <ng-container *ngFor="
                                  let column of row.columns;
                                  let j = index
                                ">
                                          <td [ngStyle]="
                                    row.enteredByGrantee
                                      ? {
                                          border: '1px solid #e4e4e4',
                                          'padding-top': '0',
                                          background: 'transparent'
                                        }
                                      : {
                                          border: '1px solid #e4e4e4',
                                          'padding-top': '0'
                                        }
                                  " [ngStyle]="
                                    column.name === 'Notes'
                                      ? {background:'23%'}
                                      : {background:'12%'}
                                  ">
                                            <mat-form-field style="margin-top: 3px"
                                              *ngIf="!currentClosure.forGranteeUse">
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        !column.dataType &&
                                        !row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" disabled readonly style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        !column.dataType &&
                                        row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'date' &&
                                        !row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" (click)="openDate(column, $event)" disabled readonly style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources' &&
                                        !row.enteredByGrantee
                                      " (blur)="showFormattedAmount($event)" #committedAmount type="number" matInput
                                                [(ngModel)]="column.value" class="anu-input text-right" disabled
                                                readonly style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources' &&
                                        !row.enteredByGrantee
                                      " #amountFormatted class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee
                                      " #committedAmount type="number" matInput [(ngModel)]="column.value"
                                                class="anu-input text-right" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee
                                      " #amountFormatted class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <input *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                            </mat-form-field>
                                            <mat-form-field style="margin-top: 3px"
                                              *ngIf="currentClosure.forGranteeUse">
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        !column.dataType &&
                                        !row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'date' &&
                                        !row.enteredByGrantee
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        !column.dataType &&
                                        row.enteredByGrantee &&
                                        row.status
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        !column.dataType &&
                                        row.enteredByGrantee &&
                                        !row.status
                                      " matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee &&
                                        row.status
                                      " matInput [(ngModel)]="column.value" class="anu-input" readonly style="
                                        color: #212529;
                                        background: #ffffff !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" (click)="openDate(column, $event)" />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee &&
                                        !row.status
                                      " matInput [(ngModel)]="column.value" class="anu-input" readonly style="
                                        color: #212529;
                                        background: #ffffff !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" (click)="openDate(column, $event)" />
                                              <mat-icon *ngIf="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee &&
                                        column.value !== '' &&
                                        column.value !== undefined
                                      " (click)="clearDate(column)" style="
                                        transform: scale(0.65);
                                        position: absolute;
                                        right: 15px;
                                        top: 21%;
                                        cursor: pointer;
                                        color: #7f7f7f;
                                      ">clear</mat-icon>
                                              <mat-icon *ngIf="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee
                                      " (click)="openDate(column, $event)" [ngStyle]="
                                        column.dataType === 'date' &&
                                        row.enteredByGrantee &&
                                        row.status &&
                                        column.value !== ''
                                          ? {
                                              transform: 'scale(0.55)',
                                              color: '#7f7f7f',
                                              position: 'absolute',
                                              right: '0',
                                              top: '21%',
                                              cursor: 'pointer'
                                            }
                                          : {
                                              transform: 'scale(0.55)',
                                              color: '#7f7f7f',
                                              position: 'absolute',
                                              right: '0',
                                              top: '21%',
                                              cursor: 'pointer'
                                            }
                                      ">calendar_today</mat-icon>
                                              <input *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        !row.enteredByGrantee
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        !row.enteredByGrantee
                                      " #amountFormatted class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee &&
                                        row.status
                                      " #amountFormatted (click)="showAmountInput($event)"
                                                class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee &&
                                        row.status
                                      " type="number" (keypress)="
                                        amountValidator.validatePositive(
                                          $event
                                        )
                                      " matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                (blur)="showFormattedAmount($event)" />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee &&
                                        !row.status
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <p [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources' &&
                                        row.enteredByGrantee &&
                                        !row.status
                                      " type="number" class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                            </mat-form-field>
                                          </td>
                                        </ng-container>
                                      </tr>
                                      <!--When row belongs to a different report-->
                                      <tr *ngIf="row.reportId !== currentClosure.id">
                                        <td [ngStyle]="
                                  row.enteredByGrantee
                                    ? {
                                        background: 'transparent',
                                        padding: '2px 4px',
                                        border: '1px solid #e4e4e4',
                                        width:'10%'
                                      }
                                    : {
                                        background: 'rgb(244,244,244)',
                                        padding: '2px 4px',
                                        border: '1px solid #e4e4e4',
                                        width:'10%'
                                      }
                                ">
                                          <p class="anu-input m-0 text-center" [ngClass]="
                                    row.enteredByGrantee &&
                                    currentClosure.forGranteeUse &&
                                    row.status
                                      ? 'dark-grey-label'
                                      : 'light-grey-label'
                                  ">
                                            <ng-container *ngIf="row.enteredByGrantee &&
                                  currentClosure.forGranteeUse &&
                                  row.status && row.reportId===currentClosure.id">* </ng-container>
                                            <ng-container *ngIf="row.enteredByGrantee &&
                                  currentClosure.forGranteeUse &&
                                  row.status && row.reportId!==currentClosure.id">** </ng-container>{{ row.name }}
                                          </p>
                                        </td>
                                        <ng-container *ngFor="
                                  let column of row.columns;
                                  let j = index
                                ">
                                          <td [ngStyle]="
                                    row.enteredByGrantee
                                      ? {
                                          border: '1px solid #d6d6d6',
                                          'padding-top': '0',
                                          background: 'transparent'
                                        }
                                      : {
                                          border: '1px solid #e4e4e4',
                                          'padding-top': '0'
                                        }
                                  " [ngStyle]="
                                    column.name === 'Notes'
                                      ? {background:'23%'}
                                      : {background:'12%'}
                                  ">
                                            <mat-form-field style="margin-top: 3px"
                                              *ngIf="!currentClosure.forGranteeUse">
                                              <input [id]="'data_' + i + '_' + j" *ngIf="!column.dataType" matInput
                                                [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" disabled readonly style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />

                                              <input [id]="'data_' + i + '_' + j" *ngIf="column.dataType === 'date'"
                                                matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" (click)="openDate(column, $event)" disabled readonly style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />

                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " (blur)="showFormattedAmount($event)" #committedAmount type="number" matInput
                                                [(ngModel)]="column.value" class="anu-input text-right" disabled
                                                readonly style="
                                        color: #212529;
                                        background: #d6d6d6 !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " #amountFormatted class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        cursor: text;
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>

                                              <input *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #f4f4f4 !important;
                                      " />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " class="anu-input w-100 text-right" style="
                                        position: absolute;
                                        top: -1px;
                                        background: #f4f4f4 !important;
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                            </mat-form-field>
                                            <mat-form-field style="margin-top: 3px"
                                              *ngIf="currentClosure.forGranteeUse">
                                              <input [id]="'data_' + i + '_' + j" *ngIf="!column.dataType" matInput
                                                [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled [ngClass]="
                                        row.status
                                          ? 'dark-grey-input'
                                          : 'light-grey-input'
                                      " />
                                              <input [id]="'data_' + i + '_' + j" *ngIf="column.dataType === 'date'"
                                                matInput [(ngModel)]="column.value" class="anu-input" [ngModelOptions]="{
                                        standAlone: true
                                      }" readonly disabled [ngClass]="
                                        row.status
                                          ? 'dark-grey-input'
                                          : 'light-grey-input'
                                      " />

                                              <input *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #d6d6d6 !important;
                                      " [ngModelOptions]="{
                                        standAlone: true
                                      }" />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name !==
                                          'Funds from Other Sources'
                                      " class="anu-input w-100 text-right" [ngClass]="
                                        row.status?'dark-grey-label-abs':'light-grey-label-abs'
                                      ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                              <input [id]="'data_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " type="number" matInput [(ngModel)]="column.value" class="anu-input text-right"
                                                readonly disabled style="
                                        color: #212529;
                                        background: #d6d6d6 !important;
                                      " />
                                              <p [id]="'label_' + i + '_' + j" *ngIf="
                                        column.dataType === 'currency' &&
                                        column.name ===
                                          'Funds from Other Sources'
                                      " #amountFormatted class="anu-input w-100 text-right" [ngClass]="
                                      row.status?'dark-grey-label-abs':'light-grey-label-abs'
                                    ">
                                                {{
                                                getFormattedCurrency(column.value)
                                                }}
                                              </p>
                                            </mat-form-field>
                                          </td>
                                        </ng-container>
                                      </tr>
                                    </ng-container>
                                  </ng-container>

                                  <div class="row">
                                    <div class="col-12">
                                    </div>
                                  </div>
                                  <tr *ngIf="
                            attribute.fieldTableValue 
                          " [ngStyle]="attribute.fieldTableValue.length>0?{background: '#f4f4f4'}:{background: '#f4f4f4',visibility:'hidden'}">
                                    <td class="py-2" style="position: sticky; left: 0; z-index: 1">
                                      <label class="w-100" style="font-weight: 600">TOTAL:</label>
                                    </td>
                                    <ng-container *ngIf="attribute.fieldTableValue[0]">
                                      <td *ngFor="
                                let column of attribute.fieldTableValue[0]
                                  .columns;
                                let j = index
                              ">
                                        <label class="text-right pr-3 my-0 w-100"
                                          *ngIf="column.dataType === 'currency'"><strong class="rf">{{
                                            getTotals(j, attribute.fieldTableValue)
                                            }}</strong></label>
                                      </td>
                                    </ng-container>
                                  </tr>
                                </table>
                              </div>
                            </div>

                            <div class="col-sm-4 col-lg-8 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse
                    ">
                              <mat-form-field>
                                <input matInput disabled placeholder="Grant Level Target:"
                                  style="background: #f0f1f0 !important" class="anu-input" [value]="
                          attribute.grantLevelTarget &&
                          attribute.grantLevelTarget !== null
                            ? attribute.grantLevelTarget
                            : 'N/A'
                        " />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-lg-8 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      currentClosure.canManage &&
                      currentClosure.forGranteeUse
                    ">
                              <mat-form-field>
                                <input matInput disabled placeholder="Grant Level Target:"
                                  style="background: #f0f1f0 !important" class="anu-input" [value]="
                          attribute.grantLevelTarget &&
                          attribute.grantLevelTarget !== null
                            ? attribute.grantLevelTarget
                            : 'N/A'
                        " />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-lg-4 text-left" *ngIf="attribute.fieldType === 'kpi'">
                              <mat-form-field>
                                <input class="anu-input" matInput placeholder="Frequency:"
                                  style="background: #f0f1f0 !important" [value]="
                          attribute.frequency === 'Half-yearly'
                            ? 'Half-Yearly'
                            : attribute.frequency === 'adhoc'
                            ? 'N/A'
                            : (attribute.frequency | titlecase)
                        " readonly disabled />
                              </mat-form-field>
                            </div>

                            <div class="col-sm-4 col-lg-4 text-left" *ngIf="attribute.fieldType === 'kpi'">
                              <mat-form-field>
                                <mat-label>Grant Level
                                  Achieved<sup>&nbsp;(1)</sup>:</mat-label>
                                <input matInput style="background: #f0f1f0 !important" [value]="
                          attribute.cumulativeActuals
                            ? attribute.cumulativeActuals
                            : 'N/A'
                        " readonly disabled class="anu-input" />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      appComp.loggedInUser.organization
                        .organizationType === 'GRANTER' &&
                      currentClosure.canManage &&
                      !currentClosure.forGranteeUse
                    ">
                              <mat-form-field>
                                <input matInput [(ngModel)]="attribute.target" class="anu-input" type="number"
                                  [ngModelOptions]="{ standAlone: true }" placeholder="Report Level Target:" />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      appComp.loggedInUser.organization
                        .organizationType === 'GRANTEE' &&
                      currentClosure.canManage &&
                      currentClosure.forGranteeUse
                    ">
                              <mat-form-field>
                                <input matInput placeholder="Report Level Target:"
                                  style="background: #f0f1f0 !important" [value]="
                          attribute.target ? attribute.target : null
                        " readonly disabled class="anu-input" />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      
                      currentClosure.canManage &&
                      ((!currentClosure.forGranteeUse && isExternalGrant(currentClosure.grant)))
                    ">
                              <mat-form-field>
                                <input matInput placeholder="Report Level Accomplishment:" [value]="
                          attribute.actualTarget
                            ? attribute.actualTarget
                            : 'To be filled by implementing organization'
                        " readonly disabled style="background: #f0f1f0 !important" class="anu-input" />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-4 col-lg-4 text-left" *ngIf="
                      attribute.fieldType === 'kpi' &&
                      
                      currentClosure.canManage &&
                      ((currentClosure.forGranteeUse && isExternalGrant(currentClosure.grant)) || (!currentClosure.forGranteeUse && !isExternalGrant(currentClosure.grant)))
                    ">
                              <mat-form-field>
                                <input matInput [(ngModel)]="attribute.actualTarget" class="anu-input" type="number"
                                  [ngModelOptions]="{ standAlone: true }" placeholder="Report Level Accomplishment:" />
                              </mat-form-field>
                            </div>
                            <div class="col-sm-12 col-lg-12 text-left" *ngIf="attribute.fieldType === 'multiline'">
                              <textarea [(ngModel)]="attribute.fieldValue" class="anu-input h-100 w-100"
                                [ngModelOptions]="{ standAlone: true }"></textarea>
                            </div>
                            <div class="col-sm-12 col-lg-12 text-left" *ngIf="attribute.fieldType === 'document'">
                              <div style="display: flex; align-items: baseline" class="attachments-wrapper">
                                <div class="col-8 pl-0 pr-1">
                                  <form class="example-form">
                                    <mat-form-field class="example-chip-list">
                                      <mat-chip-list #chipList aria-label="Fruit selection">
                                        <button class="btn btn-sm btn-blue w-100" [matAutocomplete]="auto">
                                          <mat-icon style='display:flex;align-items:center;justify-content: center;'>
                                            business</mat-icon>Browse from library
                                        </button>
                                        <input id="templateLib_{{ attribute.id }}" class="" style="
                                  max-width: 0;
                                  height: 0;
                                  padding: 0 !important;
                                  margin: 0;
                                " #fruitInput [formControl]="myControl" [matAutocomplete]="auto"
                                          [matChipInputFor]="chipList" [matChipInputSeparatorKeyCodes]="
                                  separatorKeysCodes
                                " />
                                      </mat-chip-list>
                                      <mat-autocomplete #auto="matAutocomplete" (optionSelected)="
                                selected(attribute, $event)
                              ">
                                        <ng-container *ngFor="
                                  let doc of filteredOptions | async
                                ">
                                          <mat-option [value]="doc" [disabled]="checkIfSelected(doc)">
                                            {{ doc.name }}
                                          </mat-option>
                                        </ng-container>
                                      </mat-autocomplete>
                                    </mat-form-field>
                                  </form>
                                </div>
                                <div class="col-4 pr-0">
                                  <label for="attribute_fileupload_{{ attribute.id }}"
                                    class="btn btn-sm btn-green w-100">
                                    <mat-icon style='display:flex;align-items:center;justify-content: center;'>
                                      computer
                                    </mat-icon>Browse from system
                                  </label>
                                  <input id="attribute_fileupload_{{ attribute.id }}" type="file"
                                    style="height: 0; visibility: hidden" multiple (change)="
                            processSelectedFiles(
                              section,
                              attribute,
                              $event
                            )
                          " [accept]="appComp.acceptedFileTypes" />
                                </div>
                              </div>
                              <mat-nav-list>
                                <ng-container *ngFor="let attachment of attribute.attachments">
                                  <mat-list-item>
                                    <p id="fileAttachment_{{ attachment.id }}" mat-line style="
                              border-bottom: 1px solid #d4d4d4;
                              padding-left: 0;
                            ">
                                      {{ attachment.name + "." + attachment.type }}
                                    </p>
                                    <input id="attriute_{{ attribute.id }}_attachment_{{
                              attachment.id
                            }}" mat-list-icon class="attachment-checkbox" type="checkbox" (change)="
                              handleSelection(attribute.id, attachment.id)
                            " />
                                    <button [disabled]="noSingleDocAction" class='single-doc'
                                      (click)="previewDocument('closure',attachment)">
                                      <mat-icon class="float-right"
                                        [ngClass]="noSingleDocAction?'singledoc-ico-disabled':'singledoc-ico-enabled'">
                                        remove_red_eye</mat-icon>
                                    </button>
                                    <button [disabled]="noSingleDocAction" class='single-doc'>
                                      <mat-icon class=" float-right" (click)="downloadSingleDoc(attachment.id)"
                                        [ngClass]="noSingleDocAction?'singledoc-ico-disabled':'singledoc-ico-enabled'">
                                        file_download</mat-icon>
                                    </button>
                                    <button [disabled]="noSingleDocAction" class='single-doc'
                                      (click)="deleteSingleDoc(attribute.id,attachment.id)">
                                      <mat-icon class="float-right"
                                        [ngClass]="noSingleDocAction?'singledoc-ico-disabled':'singledoc-ico-enabled'">
                                        delete_outlined</mat-icon>
                                    </button>
                                  </mat-list-item>
                                </ng-container>
                                <mat-list-item *ngIf="
                          attribute.attachments &&
                          attribute.attachments.length > 0
                        ">
                                  <button id="attachments_download_{{ attribute.id }}" class="btn btn-sm btn-blue"
                                    [disabled]="!downloadAndDeleteAllowed" (click)="downloadSelection(attribute.id)">
                                    <mat-icon style="
                              cursor: pointer;
                              top: 5px;
                              font-size: 13px;
                              margin-right: 3px;
                            ">
                                      system_update_alt
                                    </mat-icon>
                                    Download Selected Documents
                                  </button>

                                  <button id="attachments_delete_{{ attribute.id }}" class="btn btn-sm btn-blue ml-4"
                                    [disabled]="!downloadAndDeleteAllowed" (click)="deleteSelection(attribute.id)">
                                    <mat-icon style='display:flex;align-items:center;justify-content: center;'>
                                      _outlined
                                    </mat-icon>Delete Selected Documents
                                  </button>
                                </mat-list-item>
                              </mat-nav-list>
                            </div>
                          </ng-container>
                          <div class="col-12" *ngIf="
                    currentClosure.canManage &&
                    !currentClosure.forGranteeUse
                  ">
                            <div class="row mt-3">
                              <div class="col-6 text-left" *ngIf="attribute.fieldType === 'kpi'">
                                <sup>(1) - Totals based on all approved reports for
                                  grant</sup>
                              </div>
                              <div class="col-6 text-right" *ngIf="attribute.fieldType === 'kpi'">
                                <a [class]="i === 0 ? 'isDisabled' : ''" (click)="
                          moveTo(
                            section,
                            attribute,
                            i === 0 ? null : section.attributes[i - 1]
                          )
                        ">
                                  <mat-icon style='color:#676767;'>keyboard_arrow_up</mat-icon>
                                </a>
                                <a [class]="
                          i === section.attributes.length - 1
                            ? 'isDisabled'
                            : ''
                        " (click)="
                          moveTo(
                            section,
                            attribute,
                            i === section.attributes.length - 1
                              ? null
                              : section.attributes[i + 1]
                          )
                        ">
                                  <mat-icon style='color:#676767;'>keyboard_arrow_down</mat-icon>
                                </a>
                                <a><img alt="separator" src="./assets/img/Line.svg" class="w-10 mr-2"
                                    style="width: 1px" /></a>
                                <a href="javascript:" (click)="
                            deleteFieldEntry(
                              section.id,
                              attribute.id,
                              attribute.fieldName
                            )
                          ">
                                  <mat-icon style='color:#676767;'>delete_outlined</mat-icon>
                                </a>
                              </div>
                              <div class="col-12 text-right" *ngIf="attribute.fieldType !== 'kpi'">
                                <a [class]="i === 0 ? 'isDisabled' : ''" (click)="
                          moveTo(
                            section,
                            attribute,
                            i === 0 ? null : section.attributes[i - 1]
                          )
                        ">
                                  <mat-icon style='color:#676767;'>keyboard_arrow_up</mat-icon>
                                </a>
                                <a [class]="
                          i === section.attributes.length - 1
                            ? 'isDisabled'
                            : ''
                        " (click)="
                          moveTo(
                            section,
                            attribute,
                            i === section.attributes.length - 1
                              ? null
                              : section.attributes[i + 1]
                          )
                        ">
                                  <mat-icon style='color:#676767;'>keyboard_arrow_down</mat-icon>
                                </a>
                                <a><img alt="separator" src="./assets/img/Line.svg" class="w-10 mr-2"
                                    style="width: 1px" /></a>
                                <a href="javascript:" (click)="
                            deleteFieldEntry(
                              section.id,
                              attribute.id,
                              attribute.fieldName
                            )
                          ">
                                  <mat-icon style='color:#676767;'>delete_outlined</mat-icon>
                                </a>
                              </div>
                            </div>
                          </div>
                          <div class="col-12" *ngIf="
                    currentClosure.canManage && currentClosure.forGranteeUse
                  ">
                            <div class="row mt-3">
                              <div class="col-12 text-left" *ngIf="attribute.fieldType === 'kpi'">
                                <sup>(1) - Totals based on all approved reports for
                                  grant</sup>
                              </div>
                            </div>
                          </div>
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </ng-container>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div #createSectionModal class="modal fade mt-5" id="createSectionModal" tabindex="-1" role="dialog"
  aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog center-class mt-5" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="createSectionLabel"></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="fieldTitleInput" class="mat-form-field-label pull-left">Section Name:</label>
          <input id="sectionTitleInput" class="form-control" value="" />
        </div>
        <div class="row px-3">
          <button type="button" class="btn btn-sm btn-green-primary" (click)="saveSection()">
            Done
          </button>
          <button type="button" class="btn btn-sm btn-green" data-dismiss="modal">
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>